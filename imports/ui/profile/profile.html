<template name="profile">
  {{#if isVisible}}
  <div id='profileSidebar' class="col-md-3">
    {{> profileSidebar}}
  </div>
  <div class="col-md-9">
    {{#if isActiveRoute 'profileOverview'}}
      <div id="profileOverview">{{> profileOverview}}</div>
    {{/if}}

    {{#if isActiveRoute 'profileBilling'}}
      <div id="profileBilling">
        {{#if isUser}}
        {{> profileBilling}}
        {{else}}
        <h3>{{_ "permission"}}</h3>
        {{/if}}
      </div>
    {{/if}}

    {{#if isActiveRoute 'profileMembership'}}
      <div id="profileMembership">
        {{#if isUser}}
        {{> profileMembership}}
        {{else}}
        <h3>{{_ "permission"}}</h3>
        {{/if}}
      </div>
    {{/if}}

    {{#if isActiveRoute 'profileNotifications'}}
      <div id="profileNotifications">
        {{#if isUser}}
        {{> profileNotifications}}
        {{else}}
        <h3>{{_ "permission"}}</h3>
        {{/if}}
      </div>
    {{/if}}

    {{#if isActiveRoute 'profileSettings'}}
      <div id="profileSettings">
        {{#if isUser}}
        {{> profileSettings}}
        {{else}}
        <h3>{{_ "permission"}}</h3>
        {{/if}}
      </div>
    {{/if}}

    {{#if isActiveRoute 'profileRequests'}}
      <div id="profileRequests">
        {{#if isUser}}
          {{#if isInRole 'lecturer'}}
            {{> profileRequests}}
          {{else}}
            <h3>{{_ "permission"}}</h3>
          {{/if}}
        {{else}}
          <h3>{{_ "permission"}}</h3>
        {{/if}}
      </div>
    {{/if}}
  </div>
  {{else}}
  <div class="row profil-header">
    <div class="col-md-12">
      <h3 style="margin-bottom:20px">
        <span>{{_ "panel-body.profileprivate"}}</span>
      </h3>
    </div>
  </div>
  {{/if}}
</template>


<template name="profileSidebar">
    <div class="well well-sm sidebar-nav">
        <div class="input-group">
            <h5>{{_ "profil-header.name"}} {{getUser.profile.name}}</h5>
        </div>

        <div >
            <p>{{_ "panel-body.login"}} {{getService}}</p>
        </div>

        {{#if isUser}}
        <hr />

        <ul class="nav nav-pills nav-stacked">
          <li role="presentation" class="{{#if isActiveRoute 'profileOverview'}}active{{/if}}">
            <a href="/profile/{{currentUser._id}}/overview">
              <i class="fa fa-trophy"></i>{{_ "profile.overview"}}
            </a>
          </li>
          <li role="presentation" class="{{#if isActiveRoute 'profileBilling'}}active{{/if}}">
            <a href="/profile/{{currentUser._id}}/billing">
              <i class="fa fa-credit-card"></i>{{_ "profile.billing"}}
            </a>
          </li>
          <li role="presentation" class="{{#if isActiveRoute 'profileMembership'}}active{{/if}}">
            <a href="/profile/{{currentUser._id}}/membership">
              <i class="fa fa-user"></i>{{_ "profile.membership"}}
            </a>
          </li>
          <li role="presentation" class="{{#if isActiveRoute 'profileNotifications'}}active{{/if}}">
            <a href="/profile/{{currentUser._id}}/notifications">
              <i class="fa fa-bell"></i>{{_ "profile.notifications"}}
            </a>
          </li>
          <li role="presentation" class="{{#if isActiveRoute 'profileSettings'}}active{{/if}}">
            <a href="/profile/{{currentUser._id}}/settings">
              <i class="fa fa-cog"></i>{{_ "profile.settings"}}
            </a>
          </li>
          {{#if isInRole 'lecturer'}}
          <hr>
          <li role="presentation" class="{{#if isActiveRoute 'profileRequests'}}active{{/if}}">
            <a href="/profile/{{currentUser._id}}/requests">
              <i class="fa fa-check"></i>{{_ "profile.requests"}}
            </a>
          </li>
          {{/if}}
        </ul>
        {{/if}}
    </div>
</template>


<template name="profileOverview">
  <div class="row">
      {{> profileXp}}
  </div>
  <div class="row">
      {{> profileBadges}}
  </div>
</template>

<!--##################################################################-->
<!--profileSettings-->
<!--##################################################################-->
<template name="profileSettings">
    <div id="profile-info">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">{{_ "panel-heading.hallo"}}</h3>
            </div>
            <div class="panel-body">
                <form class="form-horizontal" role="form">
                    {{#if isUser}}
                    <div class="form-group">
                        <label class="col-md-4 control-label">{{_ "panel-body.email"}}</label>
                        <div class="col-md-8">
                            <input type="email" class="form-control" id="inputEmail" placeholder="{{_ "panel-body.email"}}" value="{{getUser.email}}">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label">{{_ "panel-body.profilepublic"}}</label>
                        <div class="col-md-8">
                            <div class="btn-group btn-group-justified" data-toggle="buttons">
                                <label id="profilepublicoption1" class="btn btn-default profile-public {{#if getUser.visible}}active{{/if}}">
                                    <input type="radio" name="options" value="private">
                                    <div>{{_ "panel-body.profilepublicoption1"}}</div>
                                </label>
                                <label id="profilepublicoption2" class="btn btn-default profile-private {{#unless getUser.visible}}active{{/unless}}">
                                    <input type="radio" name="options" value="public">
                                    <div>{{_ "panel-body.profilepublicoption2"}}</div>
                                </label>
                            </div>
                        </div>
                    </div>
                    {{/if}}
                </form>
            </div>
        </div>
    </div>
</template>

<!--##################################################################-->
<!--profileXp-->
<!--##################################################################-->
<template name="profileXp">
    <div class="col-md-12" id="profile-xp">
        <div class="panel panel-default">
            <div class="panel-heading panel-heading-experience">
                <h3 class="panel-title">{{_ "panel-heading-experience.experience"}}</h3>
            </div>
            <div class="panel-body panel-body-experience">
                <div class="row" style="margin-bottom:15px">
                    <div class="col-md-3">
                        <div class="well well-sm" style="margin:0; text-align:center">
                            <div class="row">
                                <span style="display:inline-block; height:50px; font-size:40px">
                  {{getXpTotal}}
                </span>
                            </div>
                            <div class="row">
                                <span class="text-muted" style="font-size:12px">
                  {{_ "panel-body-experience.total"}}
                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="well well-sm" style="margin:0; text-align:center">
                            <div class="row" style="height:50px;">
                                <span style="display:inline-block; font-size:30px; margin-top:12px">
                  {{getXpToday}}
                </span>
                            </div>
                            <div class="row">
                                <span class="text-muted" style="font-size:12px">
                  {{_ "panel-body-experience.today"}}
                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="well well-sm" style="margin:0; text-align:center">
                            <div class="row" style="height:50px;">
                                <span style="display:inline-block; font-size:25px; margin-top:17px; height:25px;">
                  {{getXpYesterday}}
                </span>
                            </div>
                            <div class="row">
                                <span class="text-muted" style="font-size:12px">
                  {{_ "panel-body-experience.yesterday"}}
                </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="well well-sm" style="margin:0; text-align:center">
                            <div class="row" style="height:50px;">
                                <span style="display:inline-block; font-size:20px; margin-top:22px; height:20px">
                  {{getXpWeek}}
                </span>
                            </div>
                            <div class="row">
                                <span class="text-muted" style="font-size:12px">
                  {{_ "panel-body-experience.days"}}
                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" style="margin-bottom:15px">
                    <div class="col-md-12">
                        <span class="text-muted">{{_ "panel-body-experience.lastredeem"}}</span>
                        <span class="pull-right text-muted">
              {{getLast}}
            </span>
                    </div>
                </div>
                <hr>

                <div class="row" style="margin-top:15px">
                    <div class="col-md-2" style="text-align:center;">
                        <div style=" width:36px; height:36px; background-image:url('/img/trophy_36x36.png')">
                            <span style="font-weight:bold; color: #000; font-size:13px; padding-top:5px; display:inline-block">
                {{getLvl}}
              </span>
                        </div>
                    </div>
                    <div class="col-md-8" style="text-align:center">
                        <div class="progress" style="margin:0">
                            <div class="progress-bar progress-bar-warning" role="progressbar" style="width: {{getXpPercent}};">
                            </div>
                        </div>
                        <small class="text-muted">
              <span>{{_ "pointslvl1"}}</span>
              <em>
                <span>{{getXp}}</span>
                <span>{{_ "pointslvl2"}}</span>
              </em>
              <span>{{_ "pointslvl3"}}</span>
            </small>
                    </div>
                    <div class="col-md-2" style="text-align:center;">
                        <div style=" width:36px; height:36px; background-image:url('/img/trophy_36x36_gray.png')">
                            <span style="font-weight:bold; color: #fff; font-size:13px; padding-top:5px; display:inline-block">
                {{getNextLvl}}
              </span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</template>

<!--##################################################################-->
<!--profileBadges-->
<!--##################################################################-->
<template name="profileBadges">
    <div class="col-md-12" id="profile-badge-region">
        <div class="panel panel-default">
            <div class="panel-heading panel-heading-badges">
                <h3 class="panel-title">{{_ "panel-heading-badges.badges"}}</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    {{#each badge in getBadges}}

                    <div class="col-md-6">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">{{badge.name}}</h3>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="row">

                                            <div class="col-md-4">
                                                <div class="well well-sm badgeWell">
                                                    <div class="row">
                                                        <img src="/badges/{{badge.badge}}_3{{#unless isGained @index 3}}_gray{{/unless}}.png" height="60">
                                                    </div>
                                                    <div class="row">
                                                        <strong>{{_ "bronze"}}</strong>
                                                    </div>
                                                    <div class="row">
                                                        <p>{{badge.rank3}} {{badge.unit}}</p>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="progress badgeFooterProgress">
                                                                <div class="progress-bar {{#if isGained @index 3}}progress-bar-success{{/if}}" role="progressbar" style="width: {{ getPercent @index 3}}%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="well well-sm badgeWell">
                                                    <div class="row">
                                                        <img src="/badges/{{badge.badge}}_2{{#unless isGained @index 2}}_gray{{/unless}}.png" height="60">
                                                    </div>
                                                    <div class="row">
                                                        <strong>{{_ "silver"}}</strong>
                                                    </div>
                                                    <div class="row">
                                                        <p>{{badge.rank2}} {{badge.unit}}</p>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="progress badgeFooterProgress">
                                                                <div class="progress-bar {{#if isGained @index 2}}progress-bar-success{{/if}}" role="progressbar" style="width: {{ getPercent @index 2}}%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="well well-sm badgeWell">
                                                    <div class="row">
                                                        <img src="/badges/{{badge.badge}}_1{{#unless isGained @index 1}}_gray{{/unless}}.png" height="60">
                                                    </div>
                                                    <div class="row">
                                                        <strong>{{_ "gold"}}</strong>
                                                    </div>
                                                    <div class="row">
                                                        <p>{{badge.rank1}} {{badge.unit}}</p>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="progress badgeFooterProgress">
                                                                <div class="progress-bar {{#if isGained @index 1}}progress-bar-success{{/if}}" role="progressbar" style="width: {{ getPercent @index 1}}%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="panel-footer">
                                <div class="row">
                                    <div class="col-md-12">

                                        <p>{{badge.desc}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {{/each}}
                </div>
            </div>
        </div>
    </div>
</template>

<!--##################################################################-->
<!--profileBilling-->
<!--##################################################################-->
<template name="profileBilling">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">{{_ "billing.payment.header"}}</h3>
        </div>
        <div class="panel-body">
            {{_ "billing.payment.desc"}}
            <form role="form">
              <div class="row">
                <div class="col-md-12">
                  <div id="subscribe-form"></div>
                  <div class="btn-group">
                      <button type="submit" class="btn btn-success">Abbonieren</button>
                  </div>
                </div>
              </div>
            </form>
        </div>
    </div>
</template>

<!--##################################################################-->
<!--profileMembership-->
<!--##################################################################-->
<template name="profileMembership">
    <div id="profile-info">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">{{_ "billing.plan.header"}}</h3>
            </div>
            <div class="panel-body">
                <div>{{_ "billing.plan.desc"}}</div>
                <br>
                <div class="col-md-6">
                    <div class="panel price {{#if isInRole 'standard'}}panel-success{{else}}panel-default{{/if}}">
                        <div class="panel-heading  text-center">
                            <h3>STANDARD</h3>
                        </div>
                        <div class="panel-body text-center">
                            <p class="lead">
                                <h2>0€</h2></p>
                        </div>
                        <ul class="list-group list-group-flush text-center">
                            <li class="list-group-item"><i class="fa fa-check"></i> {{_ "billing.plan.free"}}</li>
                            {{#if isInRole 'university'}}
                                <li class="list-group-item"><i class="fa fa-university"></i> {{_ "billing.plan.edu"}}</li>
                            {{/if}}
                        </ul>
                        <div class="panel-footer">
                            {{#if isInRole 'pro'}}
                                <button type="submit" id="downgrade" class="btn btn-block btn-default">{{_ "billing.plan.back"}}</button>
                            {{else}}
                                <button class="btn btn-block btn-success disabled" href="#">{{_ "billing.plan.actual"}}</button>
                            {{/if}}
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="panel price {{#if isInRole 'pro'}}panel-success{{else}}panel-default{{/if}}">
                        <div class="panel-heading  text-center">
                            <h3>PRO</h3>
                        </div>
                        <div class="panel-body text-center">
                            <p class="lead">
                                <h2>6.99€ / {{_ "billing.plan.month"}}</h2></p>
                        </div>
                        <ul class="list-group list-group-flush text-center">
                            <li class="list-group-item"><i class="fa fa-check"></i> {{_ "billing.plan.free"}}</li>
                            <li class="list-group-item"><i class="fa fa-university"></i> {{_ "billing.plan.edu"}}</li>
                            <li class="list-group-item"><i class="fa fa-star"></i> {{_ "billing.plan.pro"}}</li>
                        </ul>
                        <div class="panel-footer">
                            {{#if isInRole 'pro'}}
                                <button class="btn btn-block btn-success disabled">{{_ "billing.plan.actual"}}</button>
                            {{else}}
                                <form role="form">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div id="subscribe-form"></div>
                                        <button type="submit" id="upgrade" class="btn btn-block btn-default">{{_ "billing.plan.subscribe"}}</button>
                                    </div>
                                  </div>
                                </form>
                            {{/if}}
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="panel-group">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" href="#collapse1">{{_ "billing.plan.lecturer"}}</a>
                                </h4>
                            </div>
                            <div id="collapse1" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <form class="form-horizontal" id="lecturerRequestForm">
                                        <div class="form-group">
                                            <label for="inputName" class="col-sm-2 control-label">{{_ "billing.plan.name"}}</label>
                                            <div class="col-sm-10">
                                                <input type="text" class="form-control" id="inputName" placeholder="{{_ "billing.plan.name"}}">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="inputPrename" class="col-sm-2 control-label">{{_ "billing.plan.prename"}}</label>
                                            <div class="col-sm-10">
                                                <input type="text" class="form-control" id="inputPrename" placeholder="{{_ "billing.plan.prename"}}">
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="panel-footer">
                                    <button type="submit" id="sendLecturerRequest" class="btn btn-default">{{_ "billing.plan.send"}}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<!--##################################################################-->
<!--profileNotifications-->
<!--##################################################################-->
<template name="profileNotifications">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">{{_ "profile.notifications"}}</h3>
        </div>
        <div class="panel-body">
            {{#if getNotifications.count}}
                <div class="list-group">
                    {{#each getNotifications}}
                        <a href="#" class="list-group-item">
                            <h4 class="list-group-item-heading">{{type}}</h4>
                            <p class="list-group-item-text">{{text}}</p>
                        </a>
                    {{/each}}
                </div>
            {{else}}
                <div class="notification-heading">
                    <h4 class="menu-title">{{_ "notifications.noNotification"}}</h4>
                </div>
            {{/if}}
        </div>
    </div>
</template>

<!--##################################################################-->
<!--profileRequests-->
<!--##################################################################-->
<template name="profileRequests">
    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">{{_ "profile.requests"}}</h3>
        </div>
        <div class="panel-body">
            {{#if getRequests.count}}
                <div class="list-group">
                    {{#each getRequests}}
                        <a href="/cardset/{{_id}}" class="list-group-item">
                            <h4 class="list-group-item-heading">{{name}}</h4>
                            <p class="list-group-item-text">{{description}}</p>
                        </a>
                    {{/each}}
                </div>
            {{else}}
                <div class="notification-heading">
                    <h4 class="menu-title">{{_ "profile.norequests"}}</h4>
                </div>
            {{/if}}
        </div>
    </div>
</template>
