<template name="cardsets">
    {{#if isInRole 'firstLogin'}}
        {{> first_login_content_only}}
    {{else}}
        {{#if isInRole 'blocked'}}
            {{> access_denied_content_only}}
        {{else}}
            {{#if isActiveRoute 'create'}}
                {{> cardsetCourseIterationForm}}
                {{> create}}
            {{/if}}

            {{#if isActiveRoute 'learn'}}
                {{> learn}}
            {{/if}}

            {{#if isActiveRoute 'shuffle'}}
                {{> cardsetCourseIterationForm}}
                {{> shuffle}}
            {{/if}}
        {{/if}}
    {{/if}}
</template>

<template name="shuffle">
    {{#if canShuffle}}
        {{#unless isShuffleRoute}}
            {{#if shuffleList.count}}
                <a href="shuffle" id="shuffleCardsets" class="btn btn-raised btn-success" role="button">{{_
                        "set-list.shuffleCardsets"}}</a>
            {{/if}}
        {{else}}
            <div class="col-md-12" id="set-list-region">
                <div class="bs-callout bs-callout-info selectionInfo">
                    {{#if isActiveRoute 'shuffle'}}
                        <a href="learn" id="cancelShuffle" class="btn btn-raised btn-danger" role="button">{{_
                                "declinecard"}}</a>
                        {{#if gotShuffledCards}}
                            <a href="#" id="createShuffledCardset" class="btn btn-raised btn-success" role="button"
                               data-toggle="modal"
                               data-target="#setCardsetCourseIterationFormModal" {{disableIfOffline}}>{{_
                                    "set-list.shuffle"}}</a>
                        {{/if}}
                        <span class="text">
                            {{_ "set-list.shuffleInfoTextNew"}}
                        </span>
                    {{/if}}
                    {{#if isActiveRoute 'editshuffle'}}
                        {{#if gotShuffledCards}}
                            <button href="#" id="updateShuffledCardset" class="btn btn-raised btn-success"
                                    role="button" {{disableIfOffline}}>{{_
                                    "set-list.shuffle"}}</button>
                        {{/if}}
                        <button id="cancelUpdateShuffle" class="btn btn-raised btn-danger" role="button">{{_
                                "declinecard"}}</button>
                        <span class="text">
                            {{_ "set-list.shuffleInfoTextEdit"}}
                        </span>
                    {{/if}}
                    {{#if displayRemoveButton}}
                        <button href="#" id="removeShuffledCards" class="btn btn-raised btn-danger"
                                role="button" {{disableIfOffline}}>{{_
                                "set-list.shuffleRemove"}}</button>
                    {{/if}}
                </div>
                <br>
                {{#if shuffleList.count}}
                    {{> filterNavigation}}
                    <div class="responsive-utilities-test visible-on">
                        <span class="col-sm-3 hidden-xs poolHeaderBottom">{{_ "set-list.topic"}}</span>
                        <span class="col-sm-2 col-md-2 hidden-xs poolHeaderBottom">{{_ "cardType"}}</span>
                        <span class="col-sm-4 col-md-5 hidden-xs poolHeaderBottom">{{_ "set-list.description"}}</span>
                        <span class="col-sm-3 col-md-2 hidden-xs poolHeaderBottom">{{_ "selection"}}</span>
                    </div>
                    {{#each shuffleList}}
                        {{#unless isActiveCardset}}
                            <div class="col-xs-12 col-sm-12 panel panel-default {{getCardBackground this.difficulty this.cardType 1}} cardsetInfo cardsetRow responsive-utilities-test visible-on">
                                {{> cardsetRow extendContext 'index' @index}}
                            </div>
                        {{/unless}}
                    {{/each}}
                {{else}}
                    {{> cardsetEmpty}}
                {{/if}}
            </div>
        {{/unless}}
    {{/if}}
</template>

<template name="create">
    <div class="col-md-12" id="set-list-region">
        {{#unless cardsetList.count}}
            {{> shuffle}}
        {{/unless}}
        {{#if cardsetList.count}}
            <button id="newCardSet" type="button" class="btn btn-raised btn-success saveSet" data-toggle="modal"
                    data-target="#setCardsetCourseIterationFormModal" {{disableIfOffline}} {{disableIfShuffle}}>
                {{_ "set-list-empty.newset"}}
            </button>
            {{> shuffle}}
            {{> filterNavigation}}
            <div class="responsive-utilities-test visible-on">
                <span class="col-sm-3 hidden-xs poolHeaderBottom">{{_ "set-list.topic"}}</span>
                <span class="col-sm-2 hidden-xs poolHeaderBottom">{{_ "cardType"}}</span>
                <span class="col-sm-6 hidden-xs poolHeaderBottom">{{_ "set-list.description"}}</span>
                <span class="col-sm-1 hidden-xs poolHeaderBottom">{{_ "set-list.availability"}}</span>
            </div>
            {{#each cardsetList}}
                <div class="col-xs-12 panel panel-default {{getCardBackground this.difficulty this.cardType 1}} cardsetInfo cardsetRow responsive-utilities-test visible-on">
                    {{> cardsetRow extendContext 'index' @index}}
                </div>
            {{/each}}
        {{else}}
            {{> cardsetEmpty}}
        {{/if}}
    </div>
</template>

<template name="cardsetRow">
    <div class="cardsetName">
        <div class="tip-content">{{#if gotDescription
                                       this.description}}{{#markdown}}{{this.description}}{{/markdown}}{{else}}{{_
                "set-list.noDescription"}}{{/if}}</div>
        <a href="{{getLink _id}}" class="panelUnitBorder field-tip"
           title="{{_ "set-list.topic"}}: {{this.name}} ({{_ "pool.quantity"}}: {{countCards this._id}})">
        <span class="col-xs-5 visible-xs poolLabel panelUnit" data-id="{{this._id}}">{{_
                "set-list.topicMobile"}}
           :</span>
            <span id="cardsetLink{{index}}" class="cell col-xs-7 col-sm-3 {{#if isActiveRoute
                                                                                'learn'}}col-sm-3{{/if}} poolText panelUnit"
                  data-id="{{this._id}}">
                <span class="cell col-xs-9 topicName" data-id="{{this._id}}">
                    {{this.name}}
                </span>
                <span class="cell badge cardsetBadge" data-id="{{this._id}}">
                    {{countCards this._id}}
                </span>
            </span>
        </a>
    </div>
    <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription">{{_
            "cardType"}}
       :</span>
    <span class="cell col-xs-7 {{#if isActiveRoute 'learn'}}col-sm-2 panelUnit{{else}}{{#if isActiveRoute
                                                                                              'create'}}col-sm-2 panelUnit{{else}}
        {{#if isActiveRoute 'shuffle'}}col-sm-2{{else}}{{#if isActiveRoute
                                                                      'editshuffle'}}col-sm-3 col-md-2{{else}}col-sm-3 col-md-2{{/if}}{{/if}} panelUnit {{/if}}{{/if}} poolText ellipsis">
        {{getCardTypeName this.cardType}}
    </span>
    <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription">{{_
            "set-list.description"}}
       :</span>
    <span class="cell col-xs-7 {{#if isActiveRoute 'learn'}}visible-xs panelUnit{{else}}{{#if isActiveRoute
                                                                                              'create'}}col-sm-6 panelUnit{{else}}
        {{#if isActiveRoute 'shuffle'}}col-sm-4 col-md-5{{else}}{{#if isActiveRoute
                                                                      'editshuffle'}}col-sm-3 col-md-5{{else}}col-sm-4 col-md-6{{/if}}{{/if}} panelUnit {{/if}}{{/if}} poolText ellipsis">
        {{#if gotDescription this.description}}{{this.description}}{{else}}{{_
                "set-list.noDescription"}}{{/if}}
    </span>
    {{#if isActiveRoute 'learn'}}
        <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription">{{_
                "set-list.learnphase"}}
           :</span>
        <span class="hidden-sm cell col-xs-7 col-sm-1 panelUnit">
            <span class="label {{#if this.learningActive}}label-success{{else}}label-info{{/if}} labelLearning"
                  aria-label="active learnphase label">
                {{getLearnphaseStatus}}
            </span>
        </span>
        <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription">{{_
                "set-list.workload"}}
           :</span>
        <span class="{{getWorkloadType}}" data-toggle="{{#if gotWorkloadForBothTypes}}modal{{/if}}"
           data-target="{{#if gotWorkloadForBothTypes}}#selectModeToLearnModal{{/if}}" data-id="{{this._id}}">
        <span class="cell col-xs-7 col-sm-2 panelUnit" data-id="{{this._id}}">
            {{getWorkload}}
        </span>
        </span>
        <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription">{{_
                "set-list.levelOfLearning"}}
           :</span>
        <a href="progress/{{this._id}}/{{currentUser._id}}">
            <span class="cell col-xs-7 col-sm-1 poolText panelUnit panelUnitDescription panelUnitLicense manageLearning panelUnit">
           <i class="glyphicon glyphicon glyphicon-stats"></i>
        </span>
        </a>
        <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription">{{_
                "set-list.learningMode"}}
           :</span>
        <span class="cell col-xs-7 col-sm-3 col-md-2 panelUnit">
            {{getLearningMode}}
        </span>
        <a class="panelUnitBorder deleteLearned" {{disableIfOffline}}
           title='{{_ "confirm-form-learn.title"}}' data-toggle="modal" data-target="#confirmLearnModal"
           data-id="{{this._id}}">
            <span class="cell col-xs-12 col-sm-1 poolText panelUnit panelUnitDescription panelUnitLicense"
                  data-id="{{this._id}}">
           <i class="glyphicon glyphicon-log-out" data-id="{{this._id}}"></i>
        </span>
        </a>
    {{/if}}
    {{#if isShuffleRoute}}
        <span class="cell col-xs-5 col-sm-3 col-md-2 poolText panelUnit panelUnitDescription panelUnitLicense panelUnitNoBorder">
            {{#if inShuffleSelection this._id}}
                <a class="btn btn-block btn-raised btn-danger btn-sm shuffleButton removeShuffleCardset"
                   data-id="{{this._id}}">
                    <i class="fa fa-minus" data-id="{{this._id}}"></i> {{_ "admin.cardset.removeFromWordcloud"}}
                </a>
            {{else}}
                <a class="btn btn-block btn-raised btn-success btn-sm shuffleButton addShuffleCardset"
                   data-id="{{this._id}}">
                    <i class="fa fa-plus" data-id="{{this._id}}"></i> {{_ "admin.cardset.addToWordcloud"}}
                </a>
            {{/if}}
        </span>
    {{/if}}
    {{#if isActiveRoute 'create'}}
        <span class="col-xs-5 visible-xs poolLabel panelUnit panelUnitDescription panelUnitNoBorder">{{_
                "set-list.availability"}}
           :</span>
        <span class="cell col-xs-5 col-sm-1 poolText panelUnit licenseInfoCreate panelUnitDescription panelUnitLicense panelUnitNoBorder">
            {{{getKind this.kind}}}
        </span>
    {{/if}}
</template>

<template name="cardsetEmpty">
    <div class="empty-list">
        <div align="center" height="60" colspan="3" class="emptyCellList set-list-empty">
            {{#if isActiveRoute 'create'}}
                <span class="emptyTextList">
                    {{_ "set-list-empty.emptytextlist"}}
                </span>
                <br>
                <button id="setListEmpty" class="btn btn-raised btn-success btn-newSet" data-toggle="modal"
                        data-target="#setCardsetCourseIterationFormModal">{{_ "set-list-empty.newset"}}</button>
            {{/if}}

            {{#if isActiveRoute 'learn'}}
                <span class="emptyTextList">
                    {{#if canShuffle}}
                        {{_ "set-list-learn-empty.emptytextlist"}}
                    {{else}}
                        {{_ "set-list-learn-empty.emptytextlistNoShuffle"}}
                    {{/if}}
                </span>
                <br>
                <button id="browseCardset" class="btn btn-raised btn-success btn-newSet">{{_
                        "set-list-learn-empty.browseCardset"}}</button>
                <button id="browseCourse" class="btn btn-raised btn-success btn-newSet">{{_
                        "set-list-learn-empty.browseCourse"}}</button>
            {{/if}}
        </div>
    </div>
</template>

<template name="learn">
    {{> selectModeForm}}
    <div id="learn-list-region" class="col-md-12">
        {{#if learnList.count}}
            <a id="browseCardset" class="btn btn-raised btn-success">{{_
                    "set-list-learn-empty.browseCardset"}}</a>
            <a id="browseCourse" class="btn btn-raised btn-success">{{_
                    "set-list-learn-empty.browseCourse"}}</a>
        {{/if}}
        {{> shuffle}}
        {{#if learnList.count}}
            {{> filterNavigation}}
            <div class="responsive-utilities-test visible-on">
                <span class="col-sm-3 hidden-xs poolHeaderBottom">{{_ "set-list.topic"}}</span>
                <span class="col-sm-2  hidden-xs poolHeaderBottom">{{_ "cardType"}}</span>
                <span class="col-md-1  hidden-xs hidden-sm poolHeaderBottom">{{_ "set-list.learnphase"}}</span>
                <span class="col-sm-2 hidden-xs poolHeaderBottom">{{_ "set-list.workload"}}</span>
                <span class="col-sm-1 col-md-1 hidden-xs poolHeaderBottom">{{_ "set-list.levelOfLearning"}}</span>
                <span class="col-sm-3 col-md-2 hidden-xs poolHeaderBottom">{{_ "set-list.learningMode"}}</span>
                <span class="col-sm-1 hidden-xs poolHeaderBottom">{{_ "manage"}}</span>
            </div>
            {{#each learnList}}
                <div class="col-xs-12 panel panel-default {{getCardBackground this.difficulty this.cardType 1}} cardsetInfo cardsetRow responsive-utilities-test visible-on">
                    {{> cardsetRow extendContext 'index' @index}}
                </div>
            {{/each}}
        {{else}}
            {{> cardsetEmpty}}
        {{/if}}
        {{> cardsetsConfirmLearnForm}}
    </div>
</template>

<template name="selectModeForm">
    <div class="modal fade" id="selectModeToLearnModal" tabindex="-1" role="dialog"
         aria-labelledby="selectModeToLearnTitle">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="selectModeToLearnTitle" class="modal-title">{{_ "learn"}}</h4>
                </div>
                <div class="modal-body">
                    <hr/>
                    <button id="learnBox"
                            class="btn btn-raised btn-success learn" {{disableIfOffline}} data-dismiss="modal">{{_
                            "learnfile"}}</button>
                    <button id="learnMemo"
                            class="btn btn-raised btn-success memo pull-right" {{disableIfOffline}} data-dismiss="modal">{{_
                            "memo"}}</button>
                </div>
                <br>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
</template>

<template name="cardsetsConfirmLearnForm">
    <div class="modal fade" id="confirmLearnModal" tabindex="-1" role="dialog"
         aria-labelledby="confirmLearnModalTitle">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="confirmLearnModalTitle" class="modal-title">{{_ "confirm-form-learn.title"}}</h4>
                </div>
                <div class="modal-body">
                    <p>{{_ "confirm-form-learn.text"}}</p>
                    <br/>
                    <hr/>

                    <button id="learnDelete" class="btn btn-danger btn-raised btn-setDelete" {{disableIfOffline}}>{{_
                            "confirm-form-learn.title"}}</button>
                    <button id="learnCancel" class="btn btn-raised pull-right" data-dismiss="modal">{{_
                            "modal-dialog.cancel"}}</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
</template>
