<template name="bonusTaskHistoryModal">
    <div class="modal fade" id="bonusTaskHistoryModal" tabindex="-1" role="dialog"
         aria-labelledby="bonusTaskHistoryTitle">
        {{#if gotUserData}}
            <div class="modal-dialog modal-lg">
                <div class="modal-content modal-lg modal-content-for-buttons">
                    <div class="modal-header">
                    <span class="modal-icon">
                        <i class="fas fa-clock"></i>
                    </span>
                        {{> mainModalItemCloseIcon}}
                        <h4 id="bonusTaskrHistoryTitle" class="modal-title">
                            {{getTitle}}
                        </h4>
                    </div>
                    <div class="modal-body">
                        {{#if gotTaskHistoryStats}}
                            {{#with getTaskHistoryStats}}
                                <div class="user-history-title">
                                    <h4>{{_ "leitnerProgress.modal.taskHistory.stats.title"}}</h4>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover table-history-global-stats">
                                        <tbody>
                                        <tr>
                                            <td>{{_ "leitnerProgress.modal.userHistory.table.reason.title"}}:</td>
                                            <td>{{this.reason}}</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="user-history-title">
                                    <h4>{{_ "leitnerProgress.modal.userHistory.stats.workload.title"}}</h4>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover table-history-global-stats">
                                        <tbody>
                                        <tr>
                                            <td>{{_ "leitnerProgress.modal.userHistory.stats.workload.total"}}:</td>
                                            <td>{{this.workload}}</td>
                                            <td>{{_ "leitnerProgress.modal.userHistory.stats.averageKnown"}}:</td>
                                            <td>{{getScore}}</td>
                                        </tr>
                                        <tr>
                                            <td>{{_ "leitnerProgress.modal.userHistory.stats.workload.known"}}:</td>
                                            <td>{{getWorkloadCount this.known}}</td>
                                            <td>{{_ "leitnerProgress.modal.userHistory.stats.workload.notKnown"}}:</td>
                                            <td>{{getWorkloadCount this.notKnown}}</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="user-history-title">
                                    <h4>{{_ "leitnerProgress.modal.userHistory.stats.duration.title"}}</h4>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover table-history-global-stats">
                                        <tbody>
                                        <tr>
                                            <td>{{_ "leitnerProgress.modal.userHistory.stats.duration.total"}}:</td>
                                            <td>{{humanizeDuration this.duration}}</td>
                                            <td>{{_ "leitnerProgress.modal.userHistory.stats.duration.cardMedian"}}:</td>
                                            <td>{{humanizeDuration this.cardMedian}}</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            {{/with}}
                        {{/if}}
                        {{#if gotTaskHistoryData}}
                            <div class="user-history-title">
                                <h4>{{_ "leitnerProgress.modal.taskHistory.table.title"}}</h4>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <tbody>
                                    <tr>
                                        <th>{{_ "leitnerProgress.modal.taskHistory.table.card"}}</th>
                                        <th>{{_ "leitnerProgress.modal.taskHistory.table.content"}}</th>
                                        <th>{{_ "leitnerProgress.modal.taskHistory.table.answer"}}</th>
                                        <th>{{_ "leitnerProgress.modal.taskHistory.table.timeSpent"}}</th>
                                        <th>{{_ "leitnerProgress.modal.taskHistory.table.submission"}}</th>
                                    </tr>
                                    {{#each getTaskHistoryData}}
                                        <tr>
                                            <td><a href="/presentation/{{this.cardData.cardset_id}}/{{this.card_id}}" target="_blank">{{this.cardData.subject}}</a></td>
                                            <td>
                                                {{#if gotNoSideContent this.cardData.cardType}}
                                                    {{cleanContent getQuestion}}
                                                {{else}}
                                                    {{cleanContent getText}}
                                                {{/if}}
                                            </td>
                                            <td>{{getAnswer}}</td>
                                            <td>{{humanizeDuration getTime}}</td>
                                            <td>{{getMomentsDate this.timestamps.submission true}}</td>
                                        </tr>
                                    {{/each}}
                                    </tbody>
                                </table>
                            </div>
                        {{else}}
                            {{> loadingScreen}}
                            <br>
                            <br>
                        {{/if}}
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        {{/if}}
    </div>
    <!-- /.modal -->
</template>
