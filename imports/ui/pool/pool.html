<template name="pool">
    {{#if isInRole 'firstLogin'}}
        {{> first_login_content_only}}
    {{else}}
        {{#if isInRole 'blocked'}}
            {{> access_denied_content_only}}
        {{else}}
            <div id="pool-category-region" class="container">
                {{> category}}
                {{> showLicense}}
            </div>
        {{/if}}
    {{/if}}
</template>

<template name="category">
    <div class="buttonHeader">
        <div class="btn-group" role="group" aria-label="Reset group">
            <span class="col-xs-12 col-sm-12 col-md-12">
                    <button class="resetFilters btn btn-default" id="resetBtn" role="button">
                        {{_ "set-list.reset"}} </button>
            </span>
        </div>
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#pool-nav"
                            aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse" id="pool-nav">
                    <ul class="nav navbar-nav">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false" id="topicBtn" value="down">
                                {{_ "set-list.topic"}}
                                <span class="caret"></span>
                            </a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false" id="collegeBtn">
                                {{#if hasAuthorFilter}}
                                    {{poolFilterAuthor}}
                                {{else}}
                                    {{_ "set-list.author"}}
                                {{/if}}
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="#" class="filterAuthor active" data-id="">{{_ "set-list.everyone"}}</a>
                                </li>
                                {{#each getAuthors}}
                                    {{#if filterAuthors}}
                                        <li>
                                            <a href="#" class="filterAuthor"
                                               data-id="{{this._id}}">{{this.profile.title}} {{this.profile.givenname}} {{this.profile.birthname}}</a>
                                        </li>
                                    {{/if}}
                                {{/each}}
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false" id="collegeBtn">
                                {{#if hasCollegeFilter}}
                                    {{poolFilterCollege}}
                                {{else}}
                                    {{_ "set-list.college"}}
                                {{/if}}
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="#" class="filterCollege active" data-id="">{{_ "set-list.everything"}}</a>
                                </li>
                                {{#each getColleges}}
                                    <li>
                                        <a href="#" class="filterCollege"
                                           data-id="{{this.college}}">{{this.college}}</a>
                                    </li>
                                {{/each}}
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false" id="collegeBtn">
                                {{#if hasCourseFilter}}
                                    {{poolFilterCourse}}
                                {{else}}
                                    {{_ "set-list.course"}}
                                {{/if}}
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="#" class="filterCourse active" data-id="">{{_ "set-list.everything"}}</a>
                                </li>
                                {{#each getCourses}}
                                    <li>
                                        <a href="#" class="filterCourse" data-id="{{this.course}}">{{this.course}}</a>
                                    </li>
                                {{/each}}
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-haspopup="true" aria-expanded="false" id="collegeBtn">
                                {{#if hasModuleFilter}}
                                    {{poolFilterModule}}
                                {{else}}
                                    {{_ "set-list.module"}}
                                {{/if}}
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="#" class="filterModule active" data-id="">{{_ "set-list.everything"}}</a>
                                </li>
                                {{#each getModules}}
                                    <li><a href="#" class="filterModule" data-id="{{this.module}}">
                                        {{this.moduleToken}} [{{this.moduleNum}}]:
                                        {{this.module}}</a></li>
                                {{/each}}
                            </ul>
                        </li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <div id="filterCheckbox" class="btn-group" role="group" data-toggle="buttons"
                             aria-label="License group" style="padding-top: 10px;">
                            <label class="btn btn-default btn-info active">
                                <input type="checkbox" autocomplete="off" value="free" checked=""> Free
                            </label>
                            <label class="btn btn-default btn-success active">
                                <input type="checkbox" autocomplete="off" value="edu" checked=""> Edu
                            </label>
                            <label class="btn btn-default btn-danger active">
                                <input type="checkbox" autocomplete="off" value="pro" checked=""> Pro
                            </label>
                        </div>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <div class="responsive-utilities-test visible-on">

        <span class="col-md-3 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.topic"}}
        </span>
        <span class="col-md-2 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.author"}}
        </span>
        <span class="col-md-1 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.college"}}
        </span>
        <span class="col-md-2 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.course"}}
        </span>
        <span class="col-md-1 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.module"}}
        </span>

        <span class="col-md-1 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.rating"}}
        </span>

        <span class="col-md-2 visible-md visible-lg visible-xl poolHeaderBottom">{{_
                "set-list.availability"}}
        </span>
    </div>
    {{#if getDecks.count}}
        {{#each getDecks}}
            <div class="col-xs-12 col-sm-6 col-md-12 panel panel-default {{#if
                    oddRow @index}} altPanel {{/if}} cardsetInfo responsive-utilities-test visible-on">
                {{> poolCardsetRow}}
            </div>
        {{/each}}
        {{#if moreResults}}
            <div class="showMoreResults col-xs-12 col-sm-12 col-md-12 panel panel-default">
                <span class="scrollArrow col-xs-12 col-sm-12 col-md-12 glyphicon glyphicon-chevron-down"></span>
            </div>
        {{/if}}
    {{else}}
        {{> poolCardsetEmpty}}
    {{/if}}
</template>

<template name="poolCardsetRow">
    <a href="/cardset/{{_id}}" class="panelUnitBorder field-tip"
       title="{{_ "set-list.topic"}}: {{this.name}} ({{_ "pool.quantity"}}: {{countCards this._id}})">
        <div class="tip-content">{{#markdown}}{{getMaximumText this.description}}{{/markdown}}</div>
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel panelUnit">{{_ "set-list.topic"}}:</span>
        <span class="cell col-xs-8 col-sm-9 col-md-3 poolText panelUnit">
                <span class="cell col-xs-10 col-sm-10 col-md-10 topicName">
                    {{this.name}}
                </span>
                <span class="cell badge cardsetBadge">
                    {{countCards this._id}}
                </span>
        </span>
    </a>
    <a href="/profile/{{this.owner}}/settings/" title="{{_ "set-list.author"}}: {{getAuthorName this.owner}}">
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit">{{_ "set-list.author"}}
            :</span>
        <span class="col-xs-8 col-sm-9 col-md-2 poolContent poolText panelUnit">{{getAuthorName this.owner}}</span>
    </a>
    <a href="#" class="filterCollege" title="Filter {{_ "set-list.college"}}: {{this.college}}">
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit"
              data-id="{{this.college}}">{{_ "set-list.college"}}:</span>
        <span class="col-xs-8 col-sm-9 col-md-1 poolContent poolText panelUnit"
              data-id="{{this.college}}">{{this.college}}</span>
    </a>
    <a href="#" class="filterCourse" title="Filter {{_ "set-list.course"}}: {{this.course}}">
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit" data-id="{{this.course}}">{{_
                "set-list.course"}}:</span>
        <span class="col-xs-8 col-sm-9 col-md-2 poolContent poolText panelUnit"
              data-id="{{this.course}}">{{this.course}}</span>
    </a>
    <a href="#" class="filterModule" title="Filter {{_ "set-list.module"}}: {{this.module}}">
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit" data-id="{{this.module}}">{{_
                "set-list.module"}}:</span>
        <span class="col-xs-8 col-sm-9 col-md-1 poolContent poolText panelUnit"
              data-id="{{this.module}}">{{this.moduleToken}}</span>
    </a>
    <a href="#" class="filterRating"
       title="{{this.name}} {{_ "set-list.rating"}}: {{getAverageRating}} {{_ "rating-field.stars"}}">
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit">{{_ "set-list.rating"}}
            :</span>
        <span class="col-xs-8 col-sm-9 col-md-1 poolContent poolText panelUnit">
            {{> starsRating rating=getAverageRating mutable=false}}
        </span>
    </a>
    <span class="col-md-2 kind-label hidden-xs hidden-sm panelAvailability">
        <a href="#" class="filterCheckbox" title="Filter {{_ "set-list.availability"}}: {{this.kind}}">
            <span class="kind-label col-md-3 hidden-xs hidden-sm licenseInfo panelUnit panelUnitNoBorder"
                  data-id="{{this.kind}}">
                {{{getKind}}}
            </span>
            <span class="col-md-3 hidden-xs hidden-sm licenseInfo panelUnit panelUnitPrice" data-id="{{this.kind}}">
                {{{getPrice}}}
            </span>
        </a>

        <a href="#" class="showLicense" title="{{_ "set-list.licence"}}: {{this.name}}">
            <span id="info_license"
                  class="col-md-6 hidden-xs hidden-sm licenseInfo poolText panelUnit panelUnitLicense panelUnitNoBorder"
                  data-id="{{_id}}" data-toggle="modal" data-target="#showLicenseModal">
                {{getLicense}}
            </span>
        </a>
    </span>
    <a href="#" class="filterCheckbox" title="Filter {{_ "set-list.availability"}}: {{this.kind}}">
        <span class="col-xs-12 col-sm-12 visible-xs visible-sm poolLabel poolText panelAvailability"
              data-id="{{this.kind}}">
            <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit"
                  data-id="{{this.kind}}">{{_
                    "set-list.availability"}}:</span>
            <span class="kind-label col-xs-4 col-sm-4 visible-xs visible-sm licenseInfo panelUnit panelUnitKind info_license_mobile"
                  data-id="{{this.kind}}">
                {{{getKind}}}
            </span>
            <span class="col-xs-4 col-sm-5 visible-xs visible-sm licenseInfo panelUnit panelUnitPrice info_license_mobile"
                  data-id="{{this.kind}}">
                {{{getPrice}}}
            </span>
        </span>
    </a>
    <a href="#" class="showLicense panelUnitNoBorder" title="{{_ "set-list.licence"}}: {{this.name}}">
        <span class="col-xs-4 col-sm-3 visible-xs visible-sm poolLabel poolText panelUnit panelUnitNoBorder"
              data-id="{{_id}}"
              data-toggle="modal" data-target="#showLicenseModal">{{_ "set-list.licence"}}:</span>
        <span id="info_license" class="col-xs-8 col-sm-9 visible-xs visible-sm info_license_mobile panelUnitNoBorder"
              data-id="{{_id}}"
              data-toggle="modal"
              data-target="#showLicenseModal">
            {{getLicense}}
        </span>
    </a>
</template>


<template name="poolCardsetEmpty">
    <div class="col-sm-12 col-md-12 empty-list panel panel-default cardsetInfo ">
        <br>
        <span class="emptyTextList">{{_ "set-list-empty.emptypooltextlist"}}</span>
        <br>
        <br>
    </div>
</template>

<template name="showLicense">
    <div class="modal fade" id="showLicenseModal" tabindex="-1" role="dialog"
         aria-labelledby="showLicenseTitle">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="showLicenseTitle" class="modal-title">{{_ "sidebar-nav.poolLicense"}} {{_ "set-list.topic"}}
                        : {{getTopic}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">
                        <div class="form-group">
                            <div id=cc-description class="col-md-12">
                                {{#if getLicenseCount}}
                                    {{#if getLicenseType 'by'}}
                                        <img class="col-md-2" src="/img/by.large.png" alt="Namensnennung"/>
                                        <p class="col-md-10">{{_ "modal-dialog.by-desc"}}</p>
                                    {{/if}}
                                    {{#if getLicenseType 'nc'}}
                                        <img class="col-md-2" src="/img/nc-eu.large.png" alt="Nicht kommerziell"/>
                                        <p class="col-md-10">{{_ "modal-dialog.nc-desc"}}</p>
                                    {{/if}}
                                    {{#if getLicenseType 'nd'}}
                                        <img class="col-md-2" src="/img/nd.large.png" alt="Keine Bearbeitung"/>
                                        <p class="col-md-10">{{_ "modal-dialog.nd-desc"}}</p>
                                    {{/if}}
                                    {{#if getLicenseType 'sa'}}
                                        <img class="col-md-2" src="/img/sa.large.png"
                                             alt="Weitergabe unter gleichen Bedingungen"/>
                                        <p class="col-md-10">{{_ "modal-dialog.sa-desc"}}</p>
                                    {{/if}}
                                {{else}}
                                    <img class="col-md-2" src="/img/zero.large.png" alt="Keine Lizenz"/>
                                    <p class="col-md-10">{{_ "modal-dialog.zero-desc"}}</p>
                                {{/if}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
</template>
