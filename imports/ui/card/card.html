<template name="newCard">
    {{#if isInRole 'firstLogin'}}
        {{> first_login_content_only}}
    {{else}}
        {{#if isInRole 'blocked'}}
            {{> access_denied_content_only}}
        {{else}}
            {{#if isCardsetOwner this._id}}
                <div class="container">
                    {{> editor}}
                </div>
            {{else}}
                <h4>{{_ "permission"}}</h4>
            {{/if}}
        {{/if}}
    {{/if}}
</template>

<template name="editCard">
    {{#if isInRole 'firstLogin'}}
        {{> first_login_content_only}}
    {{else}}
        {{#if isInRole 'blocked'}}
            {{> access_denied_content_only}}
        {{else}}
            {{#if isEditor}}
                <div class="container">
                    {{> editor}}
                </div>
            {{else}}
                <h4>{{_ "permission"}}</h4>
            {{/if}}
        {{/if}}
    {{/if}}
</template>

<template name="editor">
    <div id="subject" class="col-md-6 cardtext">
        <h5>{{_ "cardsubject"}}</h5>
        {{> subjectEditor}}
    </div>
    <div id="difficulty" class="col-md-6 cardtext">
        <h5>{{_ "difficulty"}}</h5>
        {{> difficultyEditor}}
    </div>
    {{getContent front back hint}}
    <div class="btn-group col-xs-12 editorNavigation cardtext" role="group">
        <h5>{{_ "content"}}</h5>
        <button id="editFront" type="button" class="btn btn-primary btn-raised col-xs-12 col-sm-4" tabindex="3">{{_
                "frontside"}}</button>
        <button id="editBack" type="button" class="btn btn-default btn-raised col-xs-12 col-sm-4" tabindex="5">{{_
                "backside"}}</button>
        <button id="editHint" type="button" class="btn btn-default btn-raised col-xs-12 col-sm-4" tabindex="7">{{_
                "hint"}}</button>
    </div>
    <div id="editor" class="col-xs-12 cardtext" data-content="{{front}}">
        {{> contentEditor}}
    </div>
    <div id="preview" class="col-xs-12 cardtext">
        <h5>{{_ "preview"}}</h5>
        {{> flashcards cardset=this}}
    </div>
    {{> btnCard}}
</template>

<template name="difficultyEditor">
    <div id="difficultyGroup" class="form-group btn-group" role="group" data-toggle="buttons">
        <label id="difficulty0"
               class="col-xs-6 col-sm-3 btn btn-default btn-white {{#if isDifficultyChecked 0}}active{{/if}}"
               data-color="0">
            {{#if isDifficultyChecked 0}}
                <input type="radio" name="difficulty" value="0" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="0">
            {{/if}}
            {{_ "difficulty0"}}
        </label>
        <label id="difficulty1"
               class="col-xs-6 col-sm-3 btn btn-default btn-info {{#if isDifficultyChecked 1}}active{{/if}}"
               data-color="1">
            {{#if isDifficultyChecked 1}}
                <input type="radio" name="difficulty" value="1" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="1">
            {{/if}}

            {{_ "difficulty1"}}
        </label>
        <label id="difficulty2"
               class="col-xs-6 col-sm-3 btn btn-default btn-success {{#if isDifficultyChecked 2}}active{{/if}}"
               data-color="2">
            {{#if isDifficultyChecked 2}}
                <input type="radio" name="difficulty" value="2" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="2">
            {{/if}}
            {{_ "difficulty2"}}
        </label>
        <label id="difficulty3"
               class="col-xs-6 col-sm-3 btn btn-default btn-danger {{#if isDifficultyChecked 3}}active{{/if}}"
               data-color="3">
            {{#if isDifficultyChecked 3}}
                <input type="radio" name="difficulty" value="3" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="3">
            {{/if}}
            {{_ "difficulty3"}}
        </label>
    </div>
</template>

<template name="contentEditor">
    <form>
        <textarea id="contentEditor" name="content" data-provide="markdown" rows="10" tabindex="4">{{front}}</textarea>
    </form>
</template>

<template name="subjectEditor">
    <form tabindex="1">
        {{#if isActiveRoute 'newCard'}}
            <input class="form-control editorBackground" id="subjectEditor" name="content" value="{{getSubject}}"
                   tabindex="-1"
                   autofocus>
        {{else}}
            <input class="form-control editorBackground" id="subjectEditor" name="content" value="{{subject}}"
                   tabindex="-1"
                   autofocus>
        {{/if}}
    </form>
</template>

<template name="btnCard">
    <div class="actionButtons col-md-12">
        <br>
        <button id="cardSave"
                class="btn btn-success btn-raised saveFirst col-xs-12 col-md-2" {{disableIfOffline}} tabindex="9">
            {{_ "savecard"}}
        </button>
        <button id="cardSaveReturn"
                class="btn btn-success btn-raised save col-xs-12 col-md-3" {{disableIfOffline}} tabindex="10">
            {{_ "savecardReturn"}}
        </button>
        <button id="cardCancel" class="btn btn-default btn-raised cancel col-xs-12 col-md-2" tabindex="11">{{_
                "declinecard"}}</button>
        {{#if isEditMode}}
            {{#if isCardsetOwner this.cardset_id}}
                <button id="cardDelete"
                        class="btn btn-warning btn-raised pull-right col-xs-12 col-md-2" {{isDisabled}}
                        tabindex="12">{{_
                        "deletecard"}}</button>
                <button id="cardDeleteConfirm" style="display: none;"
                        class="btn btn-danger btn-raised pull-right col-xs-12 col-md-2">{{_ "confirmcard"}}</button>
            {{/if}}
        {{/if}}
    </div>
</template>

<template name="flashcards">
    {{> cardHint}}
    {{> copyCard}}
    <div class="{{#if isCardset}}{{#unless fullscreenActive}}col-md-9{{/unless}}{{/if}} flip-container"
         id="set-details-region">
        <div>
            <div id="cardCarousel" class="carousel slide" data-interval="false">
                <div class="carousel-inner">
                    {{#each getCards}}
                        <div class="item {{#if cardActive @index}}active{{/if}}" data-id="{{_id}}">
                            <div class="box flashcard">
                                <div class="innerBoxHeader {{getCardBackground difficulty}}-header">
                                    <div class="leftHeader">
                                        {{#if isCardEditor this.cardset_id}}
                                            {{#if isCardset}}
                                                <a id="editCard"
                                                   class="btn-editCard btn btn-raised btn-default btn-xs"
                                                   href="/cardset/{{cardset_id}}/editcard/{{_id}}" data-id="{{_id}}"
                                                   data-type="cardNavigation">
                                                    <i class="glyphicon glyphicon-pencil" data-id="{{_id}}"
                                                       data-type="cardNavigation"></i>
                                                </a>
                                            {{/if}}
                                        {{/if}}
                                        {{#if hint}}
                                            <a href="#" id="showHint">
                                                    <span class="glyphicon glyphicon-info-sign"
                                                          data-id="{{_id}}" data-type="cardNavigation"
                                                          data-toggle="modal"
                                                          data-target="#showHintModal"></span>
                                            </a>
                                        {{/if}}
                                    </div>
                                    <div class="cardNumber">
                                        {{#if isCardset}}
                                            {{cardsIndex @index}}/{{getCardsetCount}}<br>
                                        {{/if}}
                                        {{#if isBox}}
                                            {{_ "leitner_status" count=countLeitner}}
                                            <br>
                                        {{/if}}
                                        <span>{{getCardsetName}}</span><br>
                                        <span class="cardfront">{{_ "frontside"}}</span><span
                                            class="cardback" style="display:none">{{_ "backside"}}</span>
                                    </div>
                                    <div id="clicktoflip" class="clicktoflip">
                                        <img id="iconfront" class="cardside cardfront-symbol"
                                             src="/img/icon_front.png">
                                        <img id="iconback" class="cardside cardback-symbol" src="/img/icon_back.png"
                                             style="display: none;">
                                        {{_ "turn"}}
                                    </div>
                                    {{#unless isActiveRoute 'newCard'}}
                                        {{#unless isActiveRoute 'editCard'}}
                                            <a href="#" id="toggleFullscreen"
                                               class="fullscreen"
                                               data-type="cardNavigation">
                                                <span class="glyphicon glyphicon-fullscreen"
                                                      data-type="cardNavigation"></span>
                                            </a>
                                        {{/unless}}
                                    {{/unless}}
                                    <br>
                                    <div class="leftHeader2">
                                        {{#if canCopyCard this.cardset_id}}
                                            {{#if isCardset}}
                                                <a href="#" id="copyCard"
                                                   class="btn-editCard btn btn-raised btn-default btn-xs"
                                                   data-id="{{_id}}" data-type="cardNavigation" data-toggle="modal"
                                                   data-target="#showCopyCardModal">
                                                    <i class="glyphicon glyphicon-duplicate" data-id="{{_id}}"
                                                       data-type="cardNavigation"></i>
                                                </a>
                                            {{/if}}
                                        {{/if}}
                                    </div>
                                    <h3>{{subject}}</h3>
                                </div>
                                <div class="innerBoxBody {{getCardBackground difficulty}}">
                                    <div class="block">
                                        <div class="cardContent centered cardfront detailfront{{@index}}">
                                            {{#mathjax}}{{front}}{{/mathjax}}
                                        </div>
                                        <div class="cardContent centered cardback detailback{{@index}}"
                                             style="display:none">
                                            {{#mathjax}}{{back}}{{/mathjax}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {{/each}}
                </div>
                {{#if isCardset}}
                    {{#unless cardCountOne}}
                        <a id="leftCarouselControl" class="left carousel-control" href="#cardCarousel"
                           data-slide="prev">
                            <span class="icon-prev"></span>
                        </a>
                        <a id="rightCarouselControl" class="right carousel-control" href="#cardCarousel"
                           data-slide="next">
                            <span class="icon-next"></span>
                        </a>
                    {{/unless}}
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="flashcardsEmpty">
    {{#if isCardset}}
        <div class="col-md-9 flip-container" id="set-details-region">
            <div>
                <div id="cardCarousel" class="carousel slide" data-interval="false">
                    <div class="carousel-inner">
                        <div class="item active">
                            <div class="box flashcard emptyCard">
                                <h4>{{_ "nocards"}}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {{else}}
        <div class="box learn-endscreen innerBox">
            <div class="block emptyCard">
                <div class="centered front learnbox-success">{{_ "memo-empty.text"}}</div>
            </div>
        </div>
    {{/if}}
</template>

<template name="cardHint">
    <div class="modal fade" id="showHintModal" role="dialog">
        <div class="modal-dialog" aria-labelledby="showHintTitle">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="showHintTitle" class="modal-title">{{getSubject}}: {{_ "hint"}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">
                        <div class="form-group">
                            <div class="col-md-12">
                                {{#mathjax}}{{getHint}}{{/mathjax}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="copyCard">
    <div class="modal fade" id="showCopyCardModal" role="dialog">
        <div class="modal-dialog" aria-labelledby="showHintTitle">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="showHintTitle" class="modal-title">{{_ "copyCardTitle"}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">
                        <div class="form-group">
                            <div class="col-md-12">
                                {{_ "copyCardText"}}
                                <br>
                                <br>
                                <table class="table table-hover table-bordered cardListSubject">
                                    <thead>
                                    <tr>
                                        <th>
                                            <span>{{_ "navbar-collapse.carddecks"}}</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {{#each cardsetList}}
                                        <tr>
                                            <td class="copyCardset" data-id="{{this._id}}">
                                                <a href="#" data-id="{{this._id}}">
                                                    {{this.name}}
                                                </a>
                                            </td>
                                        </tr>
                                    {{/each}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
