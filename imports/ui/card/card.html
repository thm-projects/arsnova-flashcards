<template name="newCard">
    {{#if isInRole 'firstLogin'}}
        {{> first_login_content_only}}
    {{else}}
        {{#if isInRole 'blocked'}}
            {{> access_denied_content_only}}
        {{else}}
            {{#if isCardsetOwner this._id}}
                <div class="container">
                    {{> editor}}
                </div>
            {{else}}
                <h4>{{_ "permission"}}</h4>
            {{/if}}
        {{/if}}
    {{/if}}
</template>

<template name="editCard">
    {{#if isInRole 'firstLogin'}}
        {{> first_login_content_only}}
    {{else}}
        {{#if isInRole 'blocked'}}
            {{> access_denied_content_only}}
        {{else}}
            {{#if isEditor}}
                <div class="container">
                    {{> editor}}
                </div>
            {{else}}
                <h4>{{_ "permission"}}</h4>
            {{/if}}
        {{/if}}
    {{/if}}
</template>

<template name="editor">
    {{getContent}}
    <div id="subject" class="col-md-6 cardtext">
        <h5>{{_ "cardsubject"}}</h5>
        {{> subjectEditor}}
    </div>
    <div id="difficulty" class="col-md-6 cardtext">
        {{#unless isCardType 3}}
            <h5>{{_ "difficulty"}}</h5>
        {{else}}
            <h5>{{_ "difficultyNotes"}}</h5>
        {{/unless}}
        {{> difficultyEditor}}
    </div>
    <div id="cardType" class="col-xs-12 col-md-5 cardtext">
        {{> cardType}}
    </div>
    <div class="btn-group col-xs-12 editorNavigation cardtext" role="group">
        <h5>{{_ "content"}}</h5>
        <button id="editFront" type="button"
                class="btn btn-primary btn-raised col-xs-12 {{#if isCardType 2}}col-sm-3{{else}}{{#unless isCardType
                                                                                                          3}}col-sm-4{{/unless}}{{/if}}"
                tabindex="4">{{#unless isCardType 3}}{{_ "frontside"}}{{else}}{{_ "cardType3"}}{{/unless}}</button>
        {{#unless isCardType 3}}
            <button id="editBack" type="button"
                    class="btn btn-default btn-raised col-xs-12 {{#if isCardType 2}}col-sm-3{{else}}col-sm-4{{/if}}"
                    tabindex="6">{{_
                    "backside"}}</button>
            {{#if isCardType 2}}
                <button id="editLecture" type="button" class="btn btn-default btn-raised col-xs-12 col-sm-3"
                        tabindex="8">{{_
                        "cardType2"}}</button>
            {{/if}}
            <button id="editHint" type="button"
                    class="btn btn-default btn-raised col-xs-12 {{#if isCardType 2}}col-sm-3{{else}}col-sm-4{{/if}}"
                    tabindex="10">{{_
                    "hint"}}</button>
        {{/unless}}
    </div>
    <div id="editor" class="col-xs-12 cardtext" data-content="{{front}}">
        {{> contentEditor}}
    </div>
    <div id="preview" class="col-xs-12 cardtext">
        <h5>{{_ "preview"}}</h5>
        {{> flashcards cardset=this}}
    </div>
    {{> btnCard}}
</template>

<template name="cardType">
    <div id="cardTypeGroup" class="form-group btn-group" role="group" data-toggle="buttons">
        <label id="cardType0" class="col-xs-6 col-sm-3 btn btn-default btn-white {{#if isCardType 0}}active{{/if}}"
               data-type="0">
            {{#if isCardType 0}}
                <input type="radio" name="cardType" value="0" checked tabindex="3" data-type="0">
            {{else}}
                <input type="radio" name="cardType" value="0" data-type="0">
            {{/if}}
            {{_ "cardType0"}}
        </label>
        <label id="cardType1" class="col-xs-6 col-sm-3 btn btn-default btn-white {{#if isCardType 1}}active{{/if}}"
               data-type="1">
            {{#if isCardType 1}}
                <input type="radio" name="cardType" value="1" checked tabindex="3" data-type="1">
            {{else}}
                <input type="radio" name="cardType" value="1" data-type="1">
            {{/if}}

            {{_ "cardType1"}}
        </label>
        <label id="cardType2" class="col-xs-6 col-sm-3 btn btn-default btn-white {{#if isCardType 2}}active{{/if}}"
               data-type="2">
            {{#if isCardType 2}}
                <input type="radio" name="cardType" value="2" checked tabindex="3" data-type="2">
            {{else}}
                <input type="radio" name="cardType" value="2" data-type="2">
            {{/if}}
            {{_ "cardType2"}}
        </label>
        <label id="cardType3" class="col-xs-6 col-sm-3 btn btn-default btn-white {{#if isCardType 3}}active{{/if}}"
               data-type="3">
            {{#if isCardType 3}}
                <input type="radio" name="cardType" value="3" checked tabindex="3" data-type="3">
            {{else}}
                <input type="radio" name="cardType" value="3" data-type="3">
            {{/if}}
            {{_ "cardType3"}}
        </label>
    </div>
</template>

<template name="difficultyEditor">
    <div id="difficultyGroup" class="form-group btn-group" role="group" data-toggle="buttons">
        <label id="difficulty0"
               class="col-xs-6 col-sm-3 btn btn-default btn-white {{#if isDifficultyChecked 0}}active{{/if}}"
               data-color="0">
            {{#if isDifficultyChecked 0}}
                <input type="radio" name="difficulty" value="0" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="0">
            {{/if}}
            {{#unless isCardType 3}}
                {{_ "difficulty0"}}
            {{else}}
                {{_ "difficultyNotes0"}}
            {{/unless}}
        </label>
        <label id="difficulty1"
               class="col-xs-6 col-sm-3 btn btn-default btn-info {{#if isDifficultyChecked 1}}active{{/if}}"
               data-color="1">
            {{#if isDifficultyChecked 1}}
                <input type="radio" name="difficulty" value="1" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="1">
            {{/if}}
            {{#unless isCardType 3}}
                {{_ "difficulty1"}}
            {{else}}
                {{_ "difficultyNotes1"}}
            {{/unless}}
        </label>
        <label id="difficulty2"
               class="col-xs-6 col-sm-3 btn btn-default btn-success {{#if isDifficultyChecked 2}}active{{/if}}"
               data-color="2">
            {{#if isDifficultyChecked 2}}
                <input type="radio" name="difficulty" value="2" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="2">
            {{/if}}
            {{#unless isCardType 3}}
                {{_ "difficulty2"}}
            {{else}}
                {{_ "difficultyNotes2"}}
            {{/unless}}
        </label>
        <label id="difficulty3"
               class="col-xs-6 col-sm-3 btn btn-default btn-danger {{#if isDifficultyChecked 3}}active{{/if}}"
               data-color="3">
            {{#if isDifficultyChecked 3}}
                <input type="radio" name="difficulty" value="3" checked tabindex="2">
            {{else}}
                <input type="radio" name="difficulty" value="3">
            {{/if}}
            {{#unless isCardType 3}}
                {{_ "difficulty3"}}
            {{else}}
                {{_ "difficultyNotes3"}}
            {{/unless}}
        </label>
    </div>
</template>

<template name="contentEditor">
    <form>
        <textarea id="contentEditor" name="content" data-provide="markdown" rows="10" tabindex="5">{{front}}</textarea>
    </form>
</template>

<template name="subjectEditor">
    <form tabindex="1">
        {{#if isActiveRoute 'newCard'}}
            <input class="form-control editorBackground" id="subjectEditor" name="content" value="{{getSubject}}"
                   tabindex="-1"
                   autofocus>
        {{else}}
            <input class="form-control editorBackground" id="subjectEditor" name="content" value="{{subject}}"
                   tabindex="-1"
                   autofocus>
        {{/if}}
    </form>
</template>

<template name="btnCard">
    <div class="actionButtons col-md-12">
        <br>
        <button id="cardSave"
                class="btn btn-success btn-raised saveFirst col-xs-12 col-md-2" {{disableIfOffline}} tabindex="12">
            {{_ "savecard"}}
        </button>
        <button id="cardSaveReturn"
                class="btn btn-success btn-raised save col-xs-12 col-md-3" {{disableIfOffline}} tabindex="13">
            {{_ "savecardReturn"}}
        </button>
        <button id="cardCancel" class="btn btn-default btn-raised cancel col-xs-12 col-md-2" tabindex="14">{{_
                "declinecard"}}</button>
        {{#if isEditMode}}
            {{#if isCardsetOwner this.cardset_id}}
                <button id="cardDelete"
                        class="btn btn-warning btn-raised pull-right col-xs-12 col-md-2" {{isDisabled}}
                        tabindex="15">{{_
                        "deletecard"}}</button>
                <button id="cardDeleteConfirm" style="display: none;"
                        class="btn btn-danger btn-raised pull-right col-xs-12 col-md-2">{{_ "confirmcard"}}</button>
            {{/if}}
        {{/if}}
    </div>
</template>

<template name="flashcards">
    {{> cardHint}}
    {{> copyCard}}
    <div class="{{#if isCardset}}{{#unless fullscreenActive}}col-md-9{{/unless}}{{/if}} flip-container"
         id="set-details-region">
        <div>
            <div id="cardCarousel" class="carousel slide" data-interval="false">
                <div class="carousel-inner">
                    {{#each getCards}}
                        <div class="item {{#if cardActive @index}}active{{/if}}" data-id="{{_id}}">
                            <div class="box flashcard">
                                <div class="cardHeader {{getCardBackground difficulty}}-header">
                                    <div class="leftHeader">
                                        {{#if isCardEditor this.cardset_id}}
                                            {{#if isCardset}}
                                                <a id="editCard"
                                                   class="btn-editCard btn btn-raised btn-default btn-xs"
                                                   href="/cardset/{{cardset_id}}/editcard/{{_id}}" data-id="{{_id}}"
                                                   data-type="cardNavigation">
                                                    <i class="glyphicon glyphicon-pencil" data-id="{{_id}}"
                                                       data-type="cardNavigation"></i>
                                                </a>
                                            {{/if}}
                                        {{/if}}
                                        {{#unless isActiveRoute 'newCard'}}
                                            {{#unless isActiveRoute 'editCard'}}
                                                {{#if isCardType 1}}
                                                    <a id="swapOrder"
                                                       class="btn-editCard btn btn-raised btn-default btn-xs {{#if
                                                               reversedViewOrder}}pressed{{/if}} "
                                                       href="#" data-type="cardNavigation">
                                                        <i class="material-icons"
                                                           data-type="cardNavigation">swap_vert</i>
                                                    </a>
                                                {{/if}}
                                            {{/unless}}
                                        {{/unless}}
                                        {{#unless isCardType 3}}
                                            {{#if hint}}
                                                <a href="#" id="showHint">
                                                    <span class="glyphicon glyphicon-info-sign"
                                                          data-id="{{_id}}" data-type="cardNavigation"
                                                          data-toggle="modal"
                                                          data-target="#showHintModal"></span>
                                                </a>
                                            {{/if}}
                                        {{/unless}}
                                        {{#unless isCardType 0}}
                                            {{#unless isCardType 3}}
                                                <a href="#" id="showLecture">
                                                    <span class="glyphicon glyphicon {{#if isCardType
                                                                                           2}}glyphicon-education{{else}}glyphicon-book{{/if}}"
                                                          data-type="cardNavigation"
                                                          data-toggle="collapse"
                                                          data-target="#collapseLecture-{{_id}}"></span>
                                                </a>
                                            {{/unless}}
                                        {{/unless}}
                                    </div>
                                    <div class="cardNumber">
                                        {{#if isCardset}}
                                            {{cardsIndex @index}}/{{getCardsetCount}}<br>
                                        {{/if}}
                                        {{#if isBox}}
                                            {{_ "leitner_status" count=countLeitner}}
                                            <br>
                                        {{/if}}
                                        <span>{{getCardsetName}}</span><br>
                                        {{#unless isLecturePreview}}
                                            {{#unless isHintPreview}}
                                                {{#unless isCardType 3}}
                                                    <span class="cardfront" style="display: {{#if isCardType 1}}{{#if
                                                            reversedViewOrder}}none{{/if}}{{/if}}">{{_
                                                            "frontside"}}</span><span
                                                        class="cardback" style="display: {{#if isCardType 1}}{{#unless
                                                        reversedViewOrder}}none{{/unless}}{{else}}none{{/if}}">{{_
                                                        "backside"}}</span>
                                                {{/unless}}
                                            {{/unless}}
                                        {{/unless}}
                                    </div>
                                    {{#unless isLecturePreview}}
                                        {{#unless isHintPreview}}
                                            {{#unless isCardType 3}}
                                                <div id="clicktoflip" class="clicktoflip">
                                                    <img id="iconfront" class="cardside cardfront-symbol"
                                                         src="/img/icon_front.png">
                                                    <img id="iconback" class="cardside cardback-symbol"
                                                         src="/img/icon_back.png"
                                                         style="display: none;">
                                                    {{_ "turn"}}
                                                </div>
                                            {{/unless}}
                                        {{/unless}}
                                    {{/unless}}
                                    {{#unless isActiveRoute 'newCard'}}
                                        {{#unless isActiveRoute 'editCard'}}
                                            <a href="#" id="toggleFullscreen"
                                               class="fullscreen"
                                               data-type="cardNavigation">
                                                <span class="glyphicon glyphicon-fullscreen"
                                                      data-type="cardNavigation"></span>
                                            </a>
                                        {{/unless}}
                                    {{/unless}}
                                    <br>
                                    <div class="leftHeader2">
                                        {{#if canCopyCard this.cardset_id}}
                                            {{#if isCardset}}
                                                <a href="#" id="copyCard"
                                                   class="btn-editCard btn btn-raised btn-default btn-xs"
                                                   data-id="{{_id}}" data-type="cardNavigation" data-toggle="modal"
                                                   data-target="#showCopyCardModal">
                                                    <i class="glyphicon glyphicon-duplicate" data-id="{{_id}}"
                                                       data-type="cardNavigation"></i>
                                                </a>
                                            {{/if}}
                                        {{/if}}
                                    </div>
                                    <h3>{{subject}}</h3>
                                </div>
                                {{#if isHintPreview}}
                                    <div class="collapse in" id="hintPreview">
                                        <div class="cardContent centered cardlecture detaillecture{{@index}}">
                                            {{#mathjax}}{{hint}}{{/mathjax}}
                                        </div>
                                    </div>
                                {{else}}
                                    {{#unless isLecturePreview}}
                                        <div class="cardContent centered cardfront {{getCardBackground
                                                difficulty}} detailfront{{@index}}"
                                             style="display: {{#if isCardType 1}}{{#if
                                                     reversedViewOrder}}none{{/if}}{{/if}}">
                                    <span class="{{#if centerText}}center-align{{/if}}">
                                        {{#mathjax}}{{front}}{{/mathjax}}
                                    </span>
                                        </div>
                                        <div class="cardContent centered cardback {{getCardBackground
                                                difficulty}} detailback{{@index}}"
                                             style="display: {{#if isCardType 1}}{{#unless
                                                     reversedViewOrder}}none{{/unless}}{{else}}none{{/if}}">
                                    <span class="{{#if centerText}}center-align{{/if}}">
                                        {{#mathjax}}{{back}}{{/mathjax}}
                                    </span>
                                        </div>
                                    {{/unless}}
                                    {{#unless isCardType 0}}
                                        {{#unless isCardType 0}}
                                            <div class="collapse {{#if isLecturePreview}}in{{/if}}"
                                                 id="collapseLecture-{{_id}}">
                                                <div class="cardContent {{#if isCardType
                                                                              1}}cardContentDictionary{{/if}} centered cardlecture detaillecture{{@index}}">
                                                    {{#if isCardType 1}}
                                                        <iframe class="dictionaryFrame"
                                                                src="https://dict.tu-chemnitz.de/embed" frameborder="0"
                                                                data-type="cardNavigation">
                                                        </iframe>
                                                    {{/if}}
                                                    {{#if isCardType 2}}
                                                        {{#mathjax}}{{lecture}}{{/mathjax}}
                                                    {{/if}}
                                                </div>
                                            </div>
                                        {{/unless}}
                                    {{/unless}}
                                {{/if}}
                            </div>
                        </div>
                    {{/each}}
                </div>
                {{#if isCardset}}
                    {{#unless cardCountOne}}
                        <a id="leftCarouselControl" class="left carousel-control" href="#cardCarousel"
                           data-slide="prev">
                            <span class="icon-prev"></span>
                        </a>
                        <a id="rightCarouselControl" class="right carousel-control" href="#cardCarousel"
                           data-slide="next">
                            <span class="icon-next"></span>
                        </a>
                    {{/unless}}
                {{/if}}
            </div>
        </div>
    </div>
</template>

<template name="flashcardsEmpty">
    <div class="{{#if isActiveRoute 'cardsetdetailsid'}}col-md-9{{/if}} flip-container" id="set-details-region">
        <div>
            <div id="cardCarousel" class="carousel slide" data-interval="false">
                <div class="carousel-inner">
                    <div class="item active">
                        <div class="box flashcard emptyCard">
                            {{#if isActiveRoute 'cardsetdetailsid'}}
                                <h4>{{_ "nocards"}}</h4>
                            {{/if}}
                            {{#if isActiveRoute 'box'}}
                                <h4>{{_ "learnedEverything"}}</h4>
                            {{/if}}
                            {{#if isActiveRoute 'memo'}}
                                <h4>{{_ "memo-empty.text"}}</h4>
                            {{/if}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="flashcardsEnd">
    <div class="{{#if isActiveRoute 'cardsetdetailsid'}}col-md-9{{/if}} flip-container" id="set-details-region">
        <div>
            <div id="cardCarousel" class="carousel slide" data-interval="false">
                <div class="carousel-inner">
                    <div class="item active">
                        <div class="box flashcard emptyCard">
                            {{#if isActiveRoute 'box'}}
                                <h4>{{getNextCardTime}}</h4>
                            {{/if}}
                            {{#if isActiveRoute 'memo'}}
                                <h4>{{_ "memo-endscreen.text"}}</h4>
                            {{/if}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="cardHint">
    <div class="modal fade" id="showHintModal" role="dialog">
        <div class="modal-dialog" aria-labelledby="showHintTitle">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="showHintTitle" class="modal-title">{{getSubject}}: {{_ "hint"}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">
                        <div class="form-group">
                            <div class="col-md-12">
                                {{#mathjax}}{{getHint}}{{/mathjax}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="copyCard">
    <div class="modal fade" id="showCopyCardModal" role="dialog">
        <div class="modal-dialog" aria-labelledby="showHintTitle">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 id="showHintTitle" class="modal-title">{{_ "copyCardTitle"}}</h4>
                </div>
                <div class="modal-body">
                    <div class="form-horizontal">
                        <div class="form-group">
                            <div class="col-md-12">
                                {{_ "copyCardText"}}
                                <br>
                                <br>
                                <table class="table table-hover table-bordered cardListSubject">
                                    <thead>
                                    <tr>
                                        <th>
                                            <span>{{_ "navbar-collapse.carddecks"}}</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {{#each cardsetList}}
                                        <tr>
                                            <td class="copyCardset" data-id="{{this._id}}">
                                                <a href="#" data-id="{{this._id}}">
                                                    {{this.name}}
                                                </a>
                                            </td>
                                        </tr>
                                    {{/each}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>
