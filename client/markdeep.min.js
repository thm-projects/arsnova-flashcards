// jscs:disable
// jshint ignore: start
(function(){'use strict';var MARKDEEP_FOOTER='<div class="markdeepFooter"><i>formatted by <a href="http://casual-effects.com/markdeep" style="color:#999">Markdeep&nbsp;1.01&nbsp;&nbsp;</a></i><div style="display:inline-block;font-size:13px;font-family:\'Times New Roman\',serif;vertical-align:middle;transform:translate(-3px,-1px)rotate(135deg);">&#x2712;</div></div>';var _=String.prototype;_.rp=_.replace;_.ss=_.substring;_.regexIndexOf=function(regex,startpos){var i=this.ss(startpos||0).search(regex);return(i>=0)?(i+(startpos||0)):i}
	var DEBUG_SHOW_GRID=!1;var DEBUG_SHOW_SOURCE=DEBUG_SHOW_GRID;var DEBUG_HIDE_PASSTHROUGH=DEBUG_SHOW_SOURCE;var STROKE_WIDTH=2;var DIAGRAM_MARKER='*';var DIAGRAM_START=Array(5+1).join(DIAGRAM_MARKER);function entag(tag,content,attribs){return'<'+tag+(attribs?' '+attribs:'')+'>'+content+'</'+tag+'>'}
	function measureFontSize(fontStack){try{var canvas=document.createElement('canvas');var ctx=canvas.getContext('2d');ctx.font='10pt '+fontStack;return ctx.measureText("M").width}catch(e){return 10}}
	var codeFontStack="Menlo,Consolas,monospace";var codeFontSize=105.1316178/measureFontSize(codeFontStack)+'px';var BODY_STYLESHEET=entag('style','body{max-width:680px;'+'margin:auto;'+'padding:20px;'+'text-align:justify;'+'line-height:140%; '+'-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-smoothing:antialiased;'+'color:#222;'+'font-family:Palatino,Georgia,"Times New Roman",serif}');var STYLESHEET=entag('style','body{'+'counter-reset: h1 h2 h3 h4 h5 h6 paragraph'+'}'+'@page{margin:0;size:auto}'+'.md code,pre{'+'font-family:'+codeFontStack+';'+'font-size:'+codeFontSize+';'+'line-height:140%'+'}'+'.md div.title{'+'font-size:26px;'+'font-weight:800;'+'line-height:120%;'+'text-align:center'+'}'+'.md div.afterTitles{height:10px}'+'.md div.subtitle{'+'text-align:center'+'}'+'.md .image{display:inline-block}'+'.md div.imagecaption,.md div.tablecaption,.md div.listingcaption{'+'margin:5px 5px 5px 5px;'+'text-align: justify;'+'font-style:italic'+'}'+'.md div.imagecaption{'+'margin-bottom:0'+'}'+'.md img{'+'max-width:100%;'+'page-break-inside:avoid'+'}'+'.md li{text-align:left}'+'.md pre.listing {tab-size:4;-moz-tab-size:4;-o-tab-size:4}'+'.md div.tilde{'+'margin:20px 0 -10px;'+'text-align:center'+'}'+'.md blockquote.fancyquote{'+'margin:25px 0 25px;'+'text-align:left;'+'line-height:160%'+'}'+'.md blockquote.fancyquote::before{'+'content:"\u201C";'+'color:#DDD;'+'font-family:Times New Roman;'+'font-size:45px;'+'line-height:0;'+'margin-right:6px;'+'vertical-align:-0.3em'+'}'+'.md span.fancyquote{'+'font-size:118%;'+'color:#777;'+'font-style:italic'+'}'+'.md span.fancyquote::after{'+'content:"\u201D";'+'font-style:normal;'+'color:#DDD;'+'font-family:Times New Roman;'+'font-size:45px;'+'line-height:0;'+'margin-left:6px;'+'vertical-align:-0.3em'+'}'+'.md blockquote.fancyquote .author{'+'width:100%;'+'margin-top:10px;'+'display:inline-block;'+'text-align:right'+'}'+'.md small{font-size:60%}'+'.md div.title,contents,.md .tocHeader,h1,h2,h3,h4,h5,h6,.md .shortTOC,.md .mediumTOC,.nonumberh1,.nonumberh2,.nonumberh3,.nonumberh4,.nonumberh5,.nonumberh6{'+'font-family:Verdana,Helvetica,Arial,sans-serif;'+'margin:13.4px 0 13.4px;'+'padding:15px 0 3px;'+'border-top:none;'+'clear:both'+'}'+'.md h1,.md h2,.md h3,.md h4,.md h5,.md h6,.md .nonumberh1,.md .nonumberh2,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{'+'page-break-after:avoid;break-after:avoid'+'}'+'.md svg.diagram{'+'display:block;'+'font-family:'+codeFontStack+';'+'font-size:'+codeFontSize+';'+'text-align:center;'+'stroke-linecap:round;'+'stroke-width:'+STROKE_WIDTH+'px;'+'page-break-inside:avoid;'+'stroke:#000;'+'fill:#000'+'}'+'.md svg.diagram .opendot{'+'fill:#FFF'+'}'+'.md svg.diagram text{'+'stroke:none'+'}'+'@media print{.md .pagebreak{page-break-after:always;visibility:hidden}}'+'.md a{font-family:Georgia,Palatino,\'Times New Roman\'}'+'.md h1,.md .tocHeader,.md .nonumberh1{'+'border-bottom:3px solid;'+'font-size:20px;'+'font-weight:bold;'+'}'+'.md h1,.md .nonumberh1{'+'counter-reset: h2 h3 h4 h5 h6'+'}'+'.md h2,.md .nonumberh2{'+'counter-reset: h3 h4 h5 h6;'+'border-bottom:2px solid #999;'+'color:#555;'+'font-weight:bold;'+'font-size:18px;'+'}'+'.md h3,.md h4,.md h5,.md h6,.md .nonumberh3,.md .nonumberh4,.md .nonumberh5,.md .nonumberh6{'+'font-family:Helvetica,Arial,sans-serif;'+'color:#555;'+'font-size:16px;'+'}'+'.md h3{counter-reset:h4 h5 h6}'+'.md h4{counter-reset:h5 h6}'+'.md h5{counter-reset:h6}'+'.md div.table{'+'margin:16px 0 16px 0'+'}'+'.md table{'+'border-collapse:collapse;'+'line-height:140%;'+'page-break-inside:avoid'+'}'+'.md table.table{'+'margin:auto'+'}'+'.md table.calendar{'+'width:100%;'+'margin:auto;'+'font-size:11px;'+'font-family:Helvetica,Arial,sans-serif'+'}'+'.md table.calendar th{'+'font-size:16px'+'}'+'.md .today{'+'background:#ECF8FA'+'}'+'.md .calendar .parenthesized{'+'color:#999;'+'font-style:italic'+'}'+'.md div.tablecaption{'+'text-align:center'+'}'+'.md table.table th{'+'color:#FFF;'+'background-color:#AAA;'+'border:1px solid #888;'+'padding:8px 15px 8px 15px'+'}'+'.md table.table td{'+'padding:5px 15px 5px 15px;'+'border:1px solid #888'+'}'+'.md table.table tr:nth-child(even){'+'background:#EEE'+'}'+'.md pre.tilde{'+'border-top: 1px solid #CCC;'+'border-bottom: 1px solid #CCC;'+'padding: 5px 0 5px 20px;'+'margin:0 0 0 0;'+'background:#FCFCFC;'+'page-break-inside:avoid'+'}'+'.md a.target{width:0px;height:0px;visibility:hidden;font-size:0px;display:inline-block}'+'.md a:link, .md a:visited{color:#38A;text-decoration:none}'+'.md a:link:hover{text-decoration:underline}'+'.md dt{'+'font-weight:700'+'}'+'.md dl>dd{margin-top:-8px; margin-bottom:8px}'+'.md dl>table{'+'margin:35px 0 30px'+'}'+'.md code{'+'white-space:pre;'+'page-break-inside:avoid'+'}'+'.md .endnote{'+'font-size:13px;'+'line-height:15px;'+'padding-left:10px;'+'text-indent:-10px'+'}'+'.md .bib{'+'padding-left:80px;'+'text-indent:-80px;'+'text-align:left'+'}'+'.markdeepFooter{font-size:9px;text-align:right;padding-top:80px;color:#999}'+'.md .mediumTOC{float:right;font-size:12px;line-height:15px;border-left:1px solid #CCC;padding-left:15px;margin:15px 0px 15px 25px}'+'.md .mediumTOC .level1{font-weight:600}'+'.md .longTOC .level1{font-weight:600;display:block;padding-top:12px;margin:0 0 -20px}'+'.md .shortTOC{text-align:center;font-weight:bold;margin-top:15px;font-size:14px}'+'.md .admonition{'+'position:relative;'+'margin:1em 0;'+'padding:.4rem 1rem;'+'border-radius:.2rem;'+'border-left:2.5rem solid rgba(68,138,255,.4);'+'background-color:rgba(68,138,255,.15);'+'}'+'.md .admonition-title{'+'font-weight:bold;'+'border-bottom:solid 1px rgba(68,138,255,.4);'+'padding-bottom:4px;'+'margin-bottom:4px;'+'margin-left: -1rem;'+'padding-left:1rem;'+'margin-right:-1rem;'+'border-color:rgba(68,138,255,.4)'+'}'+'.md .admonition.tip{'+'border-left:2.5rem solid rgba(50,255,90,.4);'+'background-color:rgba(50,255,90,.15)'+'}'+'.md .admonition.tip::before{'+'content:"\\24d8";'+'font-weight:bold;'+'font-size:150%;'+'position:relative;'+'top:3px;'+'color:rgba(26,128,46,.8);'+'left:-2.95rem;'+'display:block;'+'width:0;'+'height:0'+'}'+'.md .admonition.tip>.admonition-title{'+'border-color:rgba(50,255,90,.4)'+'}'+'.md .admonition.warn,.md .admonition.warning{'+'border-left:2.5rem solid rgba(255,145,0,.4);'+'background-color:rgba(255,145,0,.15)'+'}'+'.md .admonition.warn::before,.md .admonition.warning::before{'+'content:"\\26A0";'+'font-weight:bold;'+'font-size:150%;'+'position:relative;'+'top:2px;'+'color:rgba(128,73,0,.8);'+'left:-2.95rem;'+'display:block;'+'width:0;'+'height:0'+'}'+'.md .admonition.warn>.admonition-title,.md .admonition.warning>.admonition-title{'+'border-color:rgba(255,145,0,.4)'+'}'+'.md .admonition.error{'+'border-left: 2.5rem solid rgba(255,23,68,.4);'+'background-color:rgba(255,23,68,.15)'+'}'+'.md .admonition.error>.admonition-title{'+'border-color:rgba(255,23,68,.4)'+'}'+'.md .admonition.error::before{'+'content: "\\2612";'+'font-family:"Arial";'+'font-size:200%;'+'position:relative;'+'color:rgba(128,12,34,.8);'+'top:-2px;'+'left:-3rem;'+'display:block;'+'width:0;'+'height:0'+'}'+'.md .admonition p:last-child{margin-bottom:0}'+'.md li.checked,.md li.unchecked{'+'list-style:none;'+'overflow:visible;'+'text-indent:-1.2em'+'}'+'.md li.checked:before,.md li.unchecked:before{'+'content:"\\2611";'+'display:block;'+'float:left;'+'width:1em;'+'font-size:120%'+'}'+'.md li.unchecked:before{'+'content:"\\2610"'+'}');var MARKDEEP_LINE='<!-- Markdeep: --><style class="fallback">body{visibility:hidden;white-space:pre;font-family:monospace}</style><script src="markdeep.min.js"></script><script src="https://casual-effects.com/markdeep/latest/markdeep.min.js?"></script><script>window.alreadyProcessedMarkdeep||(document.body.style.visibility="visible")</script>';var FRENCH={keyword:{table:'tableau',figure:'figure',listing:'liste',diagram:'diagramme',contents:'Table des matières',sec:'sec',section:'section',subsection:'paragraphe',Monday:'lundi',Tuesday:'mardi',Wednesday:'mercredi',Thursday:'jeudi',Friday:'vendredi',Saturday:'samedi',Sunday:'dimanche',January:'Janvier',February:'Février',March:'Mars',April:'Avril',May:'Mai',June:'Juin',July:'Julliet',August:'Août',September:'Septembre',October:'Octobre',November:'Novembre',December:'Décembre',jan:'janv',feb:'févr',mar:'mars',apr:'avril',may:'mai',jun:'juin',jul:'juil',aug:'août',sep:'sept',oct:'oct',nov:'nov',dec:'déc','&ldquo;':'&laquo;&nbsp;','&rtquo;':'&nbsp;&raquo;'}};var LITHUANIAN={keyword:{table:'lentelė',figure:'paveikslėlis',listing:'sąrašas',diagram:'diagrama',contents:'Turinys',sec:'sk',section:'skyrius',subsection:'poskyris',Monday:'pirmadienis',Tuesday:'antradienis',Wednesday:'trečiadienis',Thursday:'ketvirtadienis',Friday:'penktadienis',Saturday:'šeštadienis',Sunday:'sekmadienis',January:'Sausis',February:'Vasaris',March:'Kovas',April:'Balandis',May:'Gegužė',June:'Birželis',July:'Liepa',August:'Rugpjūtis',September:'Rugsėjis',October:'Spalis',November:'Lapkritis',December:'Gruodis',jan:'saus',feb:'vas',mar:'kov',apr:'bal',may:'geg',jun:'birž',jul:'liep',aug:'rugpj',sep:'rugs',oct:'spal',nov:'lapkr',dec:'gruod','&ldquo;':'&bdquo;','&rtquo;':'&ldquo;'}};var BULGARIAN={keyword:{table:'таблица',figure:'фигура',listing:'списък',diagram:'диаграма',contents:'cъдържание',sec:'сек',section:'раздел',subsection:'подраздел',Monday:'понеделник',Tuesday:'вторник',Wednesday:'сряда',Thursday:'четвъртък',Friday:'петък',Saturday:'събота',Sunday:'неделя',January:'януари',February:'февруари',March:'март',April:'април',May:'май',June:'юни',July:'юли',August:'август',September:'септември',October:'октомври',November:'ноември',December:'декември',jan:'ян',feb:'февр',mar:'март',apr:'апр',may:'май',jun:'юни',jul:'юли',aug:'авг',sep:'септ',oct:'окт',nov:'ноем',dec:'дек','&ldquo;':'&bdquo;','&rdquo;':'&rdquo;'}};var PORTUGUESE={keyword:{table:'tabela',figure:'figura',listing:'lista',diagram:'diagrama',contents:'conteúdo',sec:'sec',section:'secção',subsection:'subsecção',Monday:'Segunda-feira',Tuesday:'Terça-feira',Wednesday:'Quarta-feira',Thursday:'Quinta-feira',Friday:'Sexta-feira',Saturday:'Sábado',Sunday:'Domingo',January:'Janeiro',February:'Fevereiro',March:'Março',April:'Abril',May:'Maio',June:'Junho',July:'Julho',August:'Agosto',September:'Setembro',October:'Outubro',November:'Novembro',December:'Dezembro',jan:'jan',feb:'fev',mar:'mar',apr:'abr',may:'mai',jun:'jun',jul:'jul',aug:'ago',sep:'set',oct:'oct',nov:'nov',dec:'dez','&ldquo;':'&laquo;','&rtquo;':'&raquo;'}};var CZECH={keyword:{table:'Tabulka',figure:'Obrázek',listing:'Seznam',diagram:'Diagram',contents:'Obsah',sec:'kap.',section:'kapitola',subsection:'podkapitola',Monday:'pondělí',Tuesday:'úterý',Wednesday:'středa',Thursday:'čtvrtek',Friday:'pátek',Saturday:'sobota',Sunday:'neděle',January:'leden',February:'únor',March:'březen',April:'duben',May:'květen',June:'červen',July:'červenec',August:'srpen',September:'září',October:'říjen',November:'listopad',December:'prosinec',jan:'led',feb:'úno',mar:'bře',apr:'dub',may:'kvě',jun:'čvn',jul:'čvc',aug:'srp',sep:'zář',oct:'říj',nov:'lis',dec:'pro','&ldquo;':'&bdquo;','&rdquo;':'&ldquo;'}};var ITALIAN={keyword:{table:'tabella',figure:'figura',listing:'lista',diagram:'diagramma',contents:'indice',sec:'sez',section:'sezione',subsection:'paragrafo',Monday:'lunedì',Tuesday:'martedì',Wednesday:'mercoledì',Thursday:'giovedì',Friday:'venerdì',Saturday:'sabato',Sunday:'domenica',January:'Gennaio',February:'Febbraio',March:'Marzo',April:'Aprile',May:'Maggio',June:'Giugno',July:'Luglio',August:'Agosto',September:'Settembre',October:'Ottobre',November:'Novembre',December:'Dicembre',jan:'gen',feb:'feb',mar:'mar',apr:'apr',may:'mag',jun:'giu',jul:'lug',aug:'ago',sep:'set',oct:'ott',nov:'nov',dec:'dic','&ldquo;':'&ldquo;','&rtquo;':'&rdquo;'}};var RUSSIAN={keyword:{table:'таблица',figure:'рисунок',listing:'листинг',diagram:'диаграмма',contents:'Содержание',sec:'сек',section:'раздел',subsection:'подраздел',Monday:'понедельник',Tuesday:'вторник',Wednesday:'среда',Thursday:'четверг',Friday:'пятница',Saturday:'суббота',Sunday:'воскресенье',January:'январьr',February:'февраль',March:'март',April:'апрель',May:'май',June:'июнь',July:'июль',August:'август',September:'сентябрь',October:'октябрь',November:'ноябрь',December:'декабрь',jan:'янв',feb:'февр',mar:'март',apr:'апр',may:'май',jun:'июнь',jul:'июль',aug:'авг',sep:'сент',oct:'окт',nov:'ноябрь',dec:'дек','&ldquo;':'«','&rdquo;':'»'}};var POLISH={keyword:{table:'tabela',figure:'ilustracja',listing:'wykaz',diagram:'diagram',contents:'Spis treści',sec:'rozdz.',section:'rozdział',subsection:'podrozdział',Monday:'Poniedziałek',Tuesday:'Wtorek',Wednesday:'Środa',Thursday:'Czwartek',Friday:'Piątek',Saturday:'Sobota',Sunday:'Niedziela',January:'Styczeń',February:'Luty',March:'Marzec',April:'Kwiecień',May:'Maj',June:'Czerwiec',July:'Lipiec',August:'Sierpień',September:'Wrzesień',October:'Październik',November:'Listopad',December:'Grudzień',jan:'sty',feb:'lut',mar:'mar',apr:'kwi',may:'maj',jun:'cze',jul:'lip',aug:'sie',sep:'wrz',oct:'paź',nov:'lis',dec:'gru','&ldquo;':'&bdquo;','&rdquo;':'&rdquo;'}};var HUNGARIAN={keyword:{table:'táblázat',figure:'ábra',listing:'lista',diagram:'diagramm',contents:'Tartalomjegyzék',sec:'fej',section:'fejezet',subsection:'alfejezet',Monday:'hétfő',Tuesday:'kedd',Wednesday:'szerda',Thursday:'csütörtök',Friday:'péntek',Saturday:'szombat',Sunday:'vasárnap',January:'január',February:'február',March:'március',April:'április',May:'május',June:'június',July:'július',August:'augusztus',September:'szeptember',October:'október',November:'november',December:'december',jan:'jan',feb:'febr',mar:'márc',apr:'ápr',may:'máj',jun:'jún',jul:'júl',aug:'aug',sep:'szept',oct:'okt',nov:'nov',dec:'dec','&ldquo;':'&bdquo;','&rdquo;':'&rdquo;'}};var JAPANESE={keyword:{table:'表',figure:'図',listing:'一覧',diagram:'図',contents:'目次',sec:'章',section:'節',subsection:'項',Monday:'月',Tuesday:'火',Wednesday:'水',Thursday:'木',Friday:'金',Saturday:'土',Sunday:'日',January:'1月',February:'2月',March:'3月',April:'4月',May:'5月',June:'6月',July:'7月',August:'8月',September:'9月',October:'10月',November:'11月',December:'12月',jan:'1月',feb:'2月',mar:'3月',apr:'4月',may:'5月',jun:'6月',jul:'7月',aug:'8月',sep:'9月',oct:'10月',nov:'11月',dec:'12月','&ldquo;':'「','&rdquo;':'」'}};var GERMAN={keyword:{table:'Tabelle',figure:'Abbildung',listing:'Auflistung',diagram:'Diagramm',contents:'Inhaltsverzeichnis',sec:'Kap',section:'Kapitel',subsection:'Unterabschnitt',Monday:'Montag',Tuesday:'Dienstag',Wednesday:'Mittwoch',Thursday:'Donnerstag',Friday:'Freitag',Saturday:'Samstag',Sunday:'Sonntag',January:'Januar',February:'Februar',March:'März',April:'April',May:'Mai',June:'Juni',July:'Juli',August:'August',September:'September',October:'Oktober',November:'November',December:'Dezember',jan:'Jan',feb:'Feb',mar:'Mär',apr:'Apr',may:'Mai',jun:'Jun',jul:'Jul',aug:'Aug',sep:'Sep',oct:'Okt',nov:'Nov',dec:'Dez','&ldquo;':'&bdquo;','&rdquo;':'&ldquo;'}};var SWEDISH={keyword:{table:'tabell',figure:'figur',listing:'lista',diagram:'diagram',contents:'innehållsförteckning',sec:'sek',subsection:'undersektion',Monday:'måndag',Tuesday:'tisdag',Wednesday:'onsdag',Thursday:'torsdag',Friday:'fredag',Saturday:'lördag',Sunday:'söndag',January:'januari',February:'februari',March:'mars',April:'april',May:'maj',June:'juni',July:'juli',August:'augusti',September:'september',October:'oktober',November:'november',December:'december',jan:'jan',feb:'feb',mar:'mar',apr:'apr',may:'maj',jun:'jun',jul:'jul',aug:'aug',sep:'sep',oct:'okt',nov:'nov',dec:'dec','&ldquo;':'&rdquo;','&rdquo;':'&rdquo;'}};var DEFAULT_OPTIONS={mode:'markdeep',detectMath:!0,lang:{keyword:{}},tocStyle:'auto',hideEmptyWeekends:!0,showLabels:!1,sortScheduleLists:!0,captionAbove:{diagram:!1,image:!1,table:!1,listing:!1}};var LANG_TABLE={en:{keyword:{}},ru:RUSSIAN,fr:FRENCH,pl:POLISH,bg:BULGARIAN,de:GERMAN,hu:HUNGARIAN,sv:SWEDISH,pt:PORTUGUESE,ja:JAPANESE,it:ITALIAN,lt:LITHUANIAN,cz:CZECH};[].slice.call(document.getElementsByTagName('meta')).forEach(function(elt){var att=elt.getAttribute('lang');if(att){var lang=LANG_TABLE[att];if(lang){DEFAULT_OPTIONS.lang=lang}}});var max=Math.max;var min=Math.min;var abs=Math.abs;var sign=Math.sign||function(x){return(+x===x)?((x===0)?x:(x>0)?1:-1):NaN};function option(key,key2){if(window.markdeepOptions&&(window.markdeepOptions[key]!==undefined)){var val=window.markdeepOptions[key];if(key2){val=val[key2]
		if(val!==undefined){return val}else{return DEFAULT_OPTIONS[key][key2]}}else{return window.markdeepOptions[key]}}else if(DEFAULT_OPTIONS[key]!==undefined){if(key2){return DEFAULT_OPTIONS[key][key2]}else{return DEFAULT_OPTIONS[key]}}else{console.warn('Illegal option: "'+key+'"');return undefined}}
	function maybeShowLabel(url,tag){if(option('showLabels')){var text=' {\u00A0'+url+'\u00A0}';return tag?entag(tag,text):text}else{return''}}
	function keyword(word){return option('lang').keyword[word.toLowerCase()]||word}
	function escapeHTMLEntities(str){return String(str).rp(/&/g,'&amp;').rp(/</g,'&lt;').rp(/>/g,'&gt;').rp(/"/g,'&quot;')}
	function unescapeHTMLEntities(str){return str.rp(/&lt;/g,'<').rp(/&gt;/g,'>').rp(/&quot;/g,'"').rp(/&#39;/g,"'").rp(/&ndash;/g,'\u2013').rp(/&mdash;/g,'---').rp(/&amp;/g,'&')}
	function removeHTMLTags(str){return str.rp(/<.*?>/g,'')}
	function mangle(text){return encodeURI(text.rp(/\s/g,'').toLowerCase())}
	function sectionNumberingStylesheet(){var s='';for(var i=1;i<=6;++i){s+='.md h'+i+'::before {\ncontent:';for(var j=1;j<=i;++j){s+='counter(h'+j+') "'+((j<i)?'.':' ')+'"'}
		s+=';\ncounter-increment: h'+i+';margin-right:10px}'}
		return entag('style',s)}
	function nodeToMarkdeepSource(node,leaveEscapes){var source=node.innerHTML;source=source.rp(/<\/https?:.*>|<\/ftp:.*>|<\/[^ "\t\n>]+@[^ "\t\n>]+>/gi,'');source=source.rp(/<(https?|ftp): (.*?)>/gi,function(match,protocol,list){var s='<'+protocol+'://'+list.rp(/=""\s/g,'/');if(s.ss(s.length-3)==='=""'){s=s.ss(0,s.length-3)}
		s=s.rp(/"/g,'');return s+'>'});source=source.rp(/<style class=["']fallback["']>.*?<\/style>/gmi,'');source=unescapeHTMLEntities(source);return source}
	function extractDiagram(sourceString){function unicodeSyms(s,start,end){var p=start;for(var i=start;i<end;++i,++p){var c=s.charCodeAt(p);p+=(c>=0xD800)&&(c<=0xDBFF)}
		return p-end}
		function advance(){nextLineBeginning=sourceString.indexOf('\n',lineBeginning)+1;wideCharacters=unicodeSyms(sourceString,lineBeginning+xMin,lineBeginning+xMax);textOnLeft=textOnLeft||/\S/.test(sourceString.ss(lineBeginning,lineBeginning+xMin));noRightBorder=noRightBorder||(sourceString[lineBeginning+xMax+wideCharacters]!=='*');textOnRight=!noRightBorder&&(textOnRight||/[^ *\t\n\r]/.test(sourceString.ss(lineBeginning+xMax+wideCharacters+1,nextLineBeginning)))}
		var noDiagramResult={beforeString:sourceString,diagramString:'',alignmentHint:'',afterString:''};for(var i=sourceString.indexOf(DIAGRAM_START);i>=0;i=sourceString.indexOf(DIAGRAM_START,i+DIAGRAM_START.length)){var lineBeginning=max(0,sourceString.lastIndexOf('\n',i))+1;var xMin=i-lineBeginning;var j;for(j=i+DIAGRAM_START.length;sourceString[j]===DIAGRAM_MARKER;++j){}
			var xMax=j-lineBeginning-1;var result={beforeString:sourceString.ss(0,lineBeginning),diagramString:'',alignmentHint:'center',afterString:sourceString.ss(lineBeginning,i).rp(/[ \t]+$/,' ')};var nextLineBeginning=0,wideCharacters=0;var textOnLeft=!1,textOnRight=!1;var noRightBorder=!1;advance();for(var good=!0,previousEnding=j;good;){lineBeginning=nextLineBeginning;advance();if(lineBeginning===0){return noDiagramResult}
				if(textOnLeft){result.alignmentHint='floatright'}else if(textOnRight){result.alignmentHint='floatleft'}
				if((sourceString[lineBeginning+xMin]===DIAGRAM_MARKER)&&(!textOnLeft||(sourceString[lineBeginning+xMax+wideCharacters]===DIAGRAM_MARKER))){var x;for(x=xMin;(x<xMax)&&(sourceString[lineBeginning+x]===DIAGRAM_MARKER);++x){}
					var begin=lineBeginning+xMin;var end=lineBeginning+xMax+wideCharacters;if(!textOnLeft){var newlineLocation=sourceString.indexOf('\n',begin);if(newlineLocation!==-1){end=Math.min(end,newlineLocation)}}
					result.afterString+=sourceString.ss(previousEnding,begin).rp(/^[ \t]*[ \t]/,' ').rp(/[ \t][ \t]*$/,' ');if(x===xMax){result.afterString+=sourceString.ss(lineBeginning+xMax+1);return result}else{result.diagramString+=sourceString.ss(begin+1,end)+'\n';previousEnding=end+1}}else{good=!1}}}
		return noDiagramResult}
	function replaceMatched(string,delimiterRegExp,tag,attribs){var delimiter=delimiterRegExp.source;var flanking='[^ \\t\\n'+delimiter+']';var pattern='([^A-Za-z0-9])('+delimiter+')'+'('+flanking+'.*?(\\n.+?)*?)'+delimiter+'(?![A-Za-z0-9])';return string.rp(new RegExp(pattern,'g'),'$1<'+tag+(attribs?' '+attribs:'')+'>$3</'+tag+'>')}
	function replaceTables(s,protect){var TABLE_ROW=/(?:\n[ \t]*(?:(?:\|?[ \t\S]+?(?:\|[ \t\S]+?)+\|?)|\|[ \t\S]+\|)(?=\n))/.source;var TABLE_SEPARATOR=/\n[ \t]*(?:(?:\|? *\:?-+\:?(?: *\| *\:?-+\:?)+ *\|?|)|\|[\:-]+\|)(?=\n)/.source;var TABLE_CAPTION=/\n[ \t]*\[[^\n\|]+\][ \t]*(?=\n)/.source;var TABLE_REGEXP=new RegExp(TABLE_ROW+TABLE_SEPARATOR+TABLE_ROW+'+('+TABLE_CAPTION+')?','g');function trimTableRowEnds(row){return row.trim().rp(/^\||\|$/g,'')}
		s=s.rp(TABLE_REGEXP,function(match){var rowArray=match.split('\n');var result='';var startRow=(rowArray[0]==='')?1:0;var caption=rowArray[rowArray.length-1].trim();if((caption.length>3)&&(caption[0]==='[')&&(caption[caption.length-1]===']')){rowArray.pop();caption=caption.ss(1,caption.length-1)}else{caption=undefined}
			var columnStyle=[];trimTableRowEnds(rowArray[startRow+1]).rp(/:?-+:?/g,function(match){var left=(match[0]===':');var right=(match[match.length-1]===':');columnStyle.push(protect(' style="text-align:'+((left&&right)?'center':(right?'right':'left'))+'"'))});var row=rowArray[startRow+1].trim();var hasLeadingBar=row[0]==='|';var hasTrailingBar=row[row.length-1]==='|';var tag='th';for(var r=startRow;r<rowArray.length;++r){row=rowArray[r].trim();if(!hasLeadingBar&&(row[0]==='|')){row='&nbsp;'+row}
				if(!hasTrailingBar&&(row[row.length-1]==='|')){row+='&nbsp;'}
				row=trimTableRowEnds(row);var i=0;result+=entag('tr','<'+tag+columnStyle[0]+'> '+row.rp(/ *\| */g,function(){++i;return' </'+tag+'><'+tag+columnStyle[i]+'> '})+' </'+tag+'>')+'\n';if(r==startRow){++r;tag='td'}}
			result=entag('table',result,protect('class="table"'));if(caption){caption=entag('div',caption,protect('class="tablecaption"'));if(option('captionAbove','table')){result=caption+result}else{result='\n'+result+caption}}
			return entag('div',result,"class='table'")});return s}
	function replaceLists(s,protect){s=s.rp(/^(\s*)(?:-\s*)?(?:\[ \]|\u2610)(\s+)/mg,'$1\u2610$2');s=s.rp(/^(\s*)(?:-\s*)?(?:\[x\]|\u2611)(\s+)/mg,'$1\u2611$2');var BLANK_LINES=/\n\s*\n/.source;var PREFIX=/[:,]\s*\n/.source;var LIST_BLOCK_REGEXP=new RegExp('('+PREFIX+'|'+BLANK_LINES+'|<p>\s*\n|<br/>\s*\n?)'+/((?:[ \t]*(?:\d+\.|-|\+|\*|\u2611|\u2610)(?:[ \t]+.+\n(?:[ \t]*\n)?)+)+)/.source,'gm');var keepGoing=!0;var ATTRIBS={'+':protect('class="plus"'),'-':protect('class="minus"'),'*':protect('class="asterisk"'),'\u2611':protect('class="checked"'),'\u2610':protect('class="unchecked"')};var NUMBER_ATTRIBS=protect('class="number"');while(keepGoing){keepGoing=!1;s=s.rp(LIST_BLOCK_REGEXP,function(match,prefix,block){var result=prefix;var stack=[];var current={indentLevel:-1};block.split('\n').forEach(function(line){var trimmed=line.rp(/^\s*/,'');var indentLevel=line.length-trimmed.length;var attribs=ATTRIBS[trimmed[0]];var isUnordered=!!attribs;attribs=attribs||NUMBER_ATTRIBS;var isOrdered=/^\d+\.[ \t]/.test(trimmed);var isBlank=trimmed==='';var start=isOrdered?' '+protect('start='+trimmed.match(/^\d+/)[0]):'';if(isOrdered||isUnordered){indentLevel+=2}
		if(!current){result+='\n'+line}else if(!isOrdered&&!isUnordered&&(isBlank||(indentLevel>=current.indentLevel))){result+='\n'+current.indentChars+line}else{if(indentLevel!==current.indentLevel){if((current.indentLevel!==-1)&&(indentLevel<current.indentLevel)){while(current&&(indentLevel<current.indentLevel)){stack.pop();result+='\n</li></'+current.tag+'>';current=stack[stack.length-1]}}else{current={indentLevel:indentLevel,tag:isOrdered?'ol':'ul',indentChars:line.ss(0,indentLevel-2)};stack.push(current);result+='\n<'+current.tag+start+'>'}}else if(current.indentLevel!==-1){result+='\n</li>'}
			if(current){result+='\n'+current.indentChars+'<li '+attribs+'>'+trimmed.rp(/^(\d+\.|-|\+|\*|\u2611|\u2610) /,'')}else{result+='\n'+line;keepGoing=!0}}});result=result.replace(/\s+$/,'');for(current=stack.pop();current;current=stack.pop()){result+='</li></'+current.tag+'>'}
		return result+'\n\n'})}
		return s}
	function replaceScheduleLists(str,protect){var BEGINNING=/^(?:[^\|<>\s-\+\*\d].*[12]\d{3}(?!\d).*?|(?:[12]\d{3}(?!\.).*\d.*?)|(?:\d{1,3}(?!\.).*[12]\d{3}(?!\d).*?))/.source;var DATE_AND_TITLE='('+BEGINNING+'):'+/[ \t]+([^ \t\n].*)\n/.source;var EVENTS=/(?:[ \t]*\n)?((?:[ \t]+.+\n(?:[ \t]*\n){0,3})*)/.source;var ENTRY=DATE_AND_TITLE+EVENTS;var BLANK_LINE='\n[ \t]*\n';var ENTRY_REGEXP=new RegExp(ENTRY,'gm');var rowAttribs=protect('valign="top"');var dateTDAttribs=protect('style="width:100px;padding-right:15px" rowspan="2"');var eventTDAttribs=protect('style="padding-bottom:25px"');var DAY_NAME=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'].map(keyword);var MONTH_NAME=['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'].map(keyword);var MONTH_NAME_LIST=MONTH_NAME.join('|');var MONTH_FULL_NAME=['January','February','March','April','May','June','July','August','September','October','November','December'].map(keyword);var standardHour=9;try{var scheduleNumber=0;str=str.rp(new RegExp(BLANK_LINE+'('+ENTRY+'){2,}','gm'),function(schedule){++scheduleNumber;var entryArray=[];var anyWeekendEvents=!1;schedule.rp(ENTRY_REGEXP,function(entry,date,title,events){var year='',month='',day='',parenthesized=!1;date=date.trim();if((date[0]==='(')&&(date.slice(-1)===')')){date=date.slice(1,-1);parenthesized=!0}
		var match=date.match(RegExp('([0123]?\\d)\\D+([01]?\\d|'+MONTH_NAME_LIST+')\\D+([12]\\d{3})','i'));if(match){day=match[1];month=match[2];year=match[3]}else{match=date.match(RegExp('([12]\\d{3})\\D+([01]?\\d|'+MONTH_NAME_LIST+')\\D+([0123]?\\d)','i'));if(match){day=match[3];month=match[2];year=match[1]}else{match=date.match(RegExp('('+MONTH_NAME_LIST+')\\D+([0123]?\\d)\\D+([12]\\d{3})','i'));if(match){day=match[2];month=match[1];year=match[3]}else{throw "Could not parse date"}}}
		date=day+' '+month+' '+year;var monthNumber=parseInt(month)-1;if(isNaN(monthNumber)){monthNumber=MONTH_NAME.indexOf(month.toLowerCase())}
		var dateVal=new Date(Date.UTC(parseInt(year),monthNumber,parseInt(day),standardHour));var dayOfWeek=dateVal.getUTCDay();date=DAY_NAME[dayOfWeek]+'<br/>'+date;anyWeekendEvents=anyWeekendEvents||(dayOfWeek===0)||(dayOfWeek===6);entryArray.push({date:dateVal,title:title,sourceOrder:entryArray.length,parenthesized:parenthesized,text:parenthesized?'':entag('tr',entag('td','<a '+protect('class="target" name="schedule'+scheduleNumber+'_'+dateVal.getUTCFullYear()+'-'+(dateVal.getUTCMonth()+1)+'-'+dateVal.getUTCDate()+'"')+'>&nbsp;</a>'+date,dateTDAttribs)+entag('td',entag('b',title)),rowAttribs)+entag('tr',entag('td','\n\n'+events,eventTDAttribs),rowAttribs)});return''});var sourceEntryArray=option('sortScheduleLists')?entryArray:entryArray.slice(0);entryArray.sort(function(a,b){var ta=a.date.getTime();var tb=b.date.getTime();return(ta===tb)?(a.sourceOrder-b.sourceOrder):(ta-tb)});var MILLISECONDS_PER_DAY=1000*60*60*24;var approximateDaySpan=(entryArray[entryArray.length-1].date.getTime()-entryArray[0].date.getTime())/MILLISECONDS_PER_DAY;var today=new Date();today=new Date(Date.UTC(today.getUTCFullYear(),today.getUTCMonth(),today.getUTCDate(),standardHour));var calendar='';if((approximateDaySpan>14)&&(approximateDaySpan/entryArray.length<16)){var DAY_HEADER_ATTRIBS=protect('colspan="2" width="14%" style="padding-top:5px;text-align:center;font-style:italic"');var DATE_ATTRIBS=protect('width="1%" height="30px" style="text-align:right;border:1px solid #EEE;border-right:none;"');var FADED_ATTRIBS=protect('width="1%" height="30px" style="color:#BBB;text-align:right;"');var ENTRY_ATTRIBS=protect('width="14%" style="border:1px solid #EEE;border-left:none;"');var PARENTHESIZED_ATTRIBS=protect('class="parenthesized"');var date=entryArray[0].date;var index=0;var hideWeekends=!anyWeekendEvents&&option('hideEmptyWeekends');var showDate=hideWeekends?function(date){return(date.getUTCDay()>0)&&(date.getUTCDay()<6)}:function(){return!0};var sameDay=function(d1,d2){return(abs(d1.getTime()-d2.getTime())<MILLISECONDS_PER_DAY/2)}
		date=new Date(date.getUTCFullYear(),date.getUTCMonth(),1,standardHour);while(date.getTime()<entryArray[entryArray.length-1].date.getTime()){calendar+='<table '+protect('class="calendar"')+'>\n'+entag('tr',entag('th',MONTH_FULL_NAME[date.getUTCMonth()]+' '+date.getUTCFullYear(),protect('colspan="14"')))+'<tr>';(hideWeekends?DAY_NAME.slice(1,6):DAY_NAME).forEach(function(name){calendar+=entag('td',name,DAY_HEADER_ATTRIBS)});calendar+='</tr>';while(date.getUTCDay()!==0){date=new Date(date.getTime()-MILLISECONDS_PER_DAY)}
			if(date.getDate()!==1){calendar+='<tr '+rowAttribs+'>';while(date.getDate()!==1){if(showDate(date)){calendar+='<td '+FADED_ATTRIBS+'>'+date.getUTCDate()+'</td><td>&nbsp;</td>'}
				date=new Date(date.getTime()+MILLISECONDS_PER_DAY)}}
			do{if(date.getUTCDay()===0){calendar+='<tr '+rowAttribs+'>'}
				if(showDate(date)){var attribs='';if(sameDay(date,today)){attribs=protect('class="today"')}
					var contents='';for(var entry=entryArray[index];entry&&sameDay(entry.date,date);++index,entry=entryArray[index]){if(contents){contents+='<br/>'}
						if(entry.parenthesized){contents+=entag('span',entry.title,PARENTHESIZED_ATTRIBS)}else{contents+=entag('a',entry.title,protect('href="#schedule'+scheduleNumber+'_'+date.getUTCFullYear()+'-'+(date.getUTCMonth()+1)+'-'+date.getUTCDate()+'"'))}}
					if(contents){calendar+=entag('td',entag('b',date.getUTCDate()),DATE_ATTRIBS+attribs)+entag('td',contents,ENTRY_ATTRIBS+attribs)}else{calendar+='<td '+DATE_ATTRIBS+attribs+'></a>'+date.getUTCDate()+'</td><td '+ENTRY_ATTRIBS+attribs+'> &nbsp; </td>'}}
				if(date.getUTCDay()===6){calendar+='</tr>'}
				date=new Date(date.getTime()+MILLISECONDS_PER_DAY)}while(date.getUTCDate()>1);if(date.getUTCDay()!==0){while(date.getUTCDay()!==0){if(showDate(date)){calendar+='<td '+FADED_ATTRIBS+'>'+date.getUTCDate()+'</td><td>&nbsp</td>'}
				date=new Date(date.getTime()+MILLISECONDS_PER_DAY)}
				calendar+='</tr>'}
			calendar+='</table><br/>\n';date=new Date(Date.UTC(date.getUTCFullYear(),date.getUTCMonth(),1,standardHour))}}
		schedule='';sourceEntryArray.forEach(function(entry){schedule+=entry.text});return'\n\n'+calendar+entag('table',schedule,protect('class="schedule"'))+'\n\n'})}catch(ignore){}
		return str}
	function replaceDefinitionLists(s,protect){var TERM=/^.+\n:(?=[ \t])/.source;var DEFINITION='(\s*\n|[: \t].+\n)+';s=s.rp(new RegExp('('+TERM+DEFINITION+')+','gm'),function(block){var list=[];var currentEntry=null;block.split('\n').forEach(function(line,i){if(line.trim().length===0){if(currentEntry){currentEntry.definition+='\n'}}else if(!/\s/.test(line[0])&&(line[0]!==':')){currentEntry={term:line,definition:''};list.push(currentEntry)}else{if(line[0]===':'){line=' '+line.ss(1)}
		currentEntry.definition+=line+'\n'}});var longestDefinition=0;list.forEach(function(entry){if(/\n\s*\n/.test(entry.definition.trim())){longestDefinition=Infinity}else{longestDefinition=max(longestDefinition,unescapeHTMLEntities(removeHTMLTags(entry.definition)).length)}});var result='';if(longestDefinition<160){var rowAttribs=protect('valign=top');list.forEach(function(entry){result+=entag('tr',entag('td',entag('dt',entry.term))+entag('td',entag('dd',entag('p',entry.definition))),rowAttribs)});result=entag('table',result)}else{list.forEach(function(entry){result+=entag('dt',entry.term)+entag('dd',entag('p',entry.definition))})}
		return entag('dl',result)});return s}
	function insertTableOfContents(s,protect){var fullTOC='';var shortTOC='';var headerCounter=[0];var currentLevel=0;var numAboveLevel1=0;var table={};s=s.rp(/<h([1-6])>(.*?)<\/h\1>/gi,function(header,level,text){level=parseInt(level)
		text=text.trim();for(var i=currentLevel;i<level;++i){headerCounter[i]=0}
		headerCounter.splice(level,currentLevel-level);currentLevel=level;++headerCounter[currentLevel-1];var number=headerCounter.join('.');var name='toc'+number;table[removeHTMLTags(text).trim().toLowerCase()]=number;if(level<=3){fullTOC+=Array(level).join('&nbsp;&nbsp;')+'<a href="#'+name+'" class="level'+level+'"><span class="tocNumber">'+number+'&nbsp; </span>'+text+'</a><br/>\n';if(level===1){shortTOC+=' &middot; <a href="#'+name+'">'+text+'</a>'}else{++numAboveLevel1}}
		return entag('a','&nbsp;',protect('class="target" name="'+name+'"'))+header});if(shortTOC.length>0){shortTOC=shortTOC.ss(10)}
		var numLevel1=headerCounter[0];var numHeaders=numLevel1+numAboveLevel1;var firstHeaderLocation=s.regexIndexOf(/((<a\s+\S+>&nbsp;<\/a>)\s*)*?<h\d>/i);if(firstHeaderLocation===-1){firstHeaderLocation=0}
		var AFTER_TITLES='<div class="afterTitles"><\/div>';var insertLocation=s.indexOf(AFTER_TITLES);if(insertLocation===-1){insertLocation=0}else{insertLocation+=AFTER_TITLES.length}
		var tocStyle=option('tocStyle');var TOC='';if((tocStyle==='auto')||(tocStyle==='')){if(((numHeaders<4)&&(numLevel1<=1))||(s.length<2048)){tocStyle='none'}else if((numLevel1<7)&&(numHeaders/numLevel1<2.5)){tocStyle='short'}else if((firstHeaderLocation===-1)||(firstHeaderLocation/55>numHeaders)){tocStyle='medium'}else{tocStyle='long'}}
		switch(tocStyle){case 'none':case '':break;case 'short':TOC='<div class="shortTOC">'+shortTOC+'</div>';break;case 'medium':TOC='<div class="mediumTOC"><center><b>'+keyword('Contents')+'</b></center><p>'+fullTOC+'</p></div>';break;case 'long':insertLocation=firstHeaderLocation;TOC='<div class="longTOC"><div class="tocHeader">'+keyword('Contents')+'</div><p>'+fullTOC+'</p></div>';break;default:console.log('markdeepOptions.tocStyle = "'+tocStyle+'" specified in your document is not a legal value')}
		s=s.ss(0,insertLocation)+TOC+s.ss(insertLocation);return[s,table]}
	function escapeRegExpCharacters(str){return str.rp(/([\.\[\]\(\)\*\+\?\^\$\\\{\}\|])/g,'\\$1')}
	function isolated(preSpaces,postSpaces){if(preSpaces&&postSpaces){preSpaces=preSpaces.match(/\n/g);postSpaces=postSpaces.match(/\n/g);return preSpaces&&(preSpaces.length>1)&&postSpaces&&(postSpaces.length>1)}else{return!1}}
	function markdeepToHTML(str,elementMode){var endNoteTable={},endNoteCount=0;var referenceLinkTable={};var PROTECT_CHARACTER='\ue010';var PROTECT_RADIX=35;var protectedStringArray=[];var PROTECT_DIGITS=4;var PROTECT_REGEXP=RegExp(PROTECT_CHARACTER+'[0-9a-wyz]{'+PROTECT_DIGITS+','+PROTECT_DIGITS+'}'+PROTECT_CHARACTER,'g');function protect(s){var i=(protectedStringArray.push(s)-1).toString(PROTECT_RADIX);i=i.rp(/x/gi,'z');while(i.length<PROTECT_DIGITS){i='0'+i}
		return PROTECT_CHARACTER+i+PROTECT_CHARACTER}
		function expose(i){var j=parseInt(i.ss(1,i.length-1).rp(/z/g,'x'),PROTECT_RADIX);return protectedStringArray[j]}
		function protector(match,protectee){return protect(protectee)}
		function protectorWithPrefix(match,prefix,protectee){return prefix+protect(protectee)}
		function makeHeaderFunc(level){return function(match,header){return'\n\n</p>\n<a '+protect('class="target" name="'+mangle(removeHTMLTags(header))+'"')+'>&nbsp;</a>'+entag('h'+level,header)+'\n<p>\n\n'}}
		if(elementMode===undefined){elementMode=!0}
		if(str.innerHTML!==undefined){str=str.innerHTML}
		str='\n\n'+str;str=str.rp(/<script\s+type\s*=\s*['"]preformatted['"]\s*>([\s\S]*?)<\/script>/gi,'$1');function replaceDiagrams(str){var result=extractDiagram(str);if(result.diagramString){var CAPTION_REGEXP=/^\n*[ \t]*\[[^\n]+\][ \t]*(?=\n)/;result.afterString=result.afterString.rp(CAPTION_REGEXP,function(caption){caption=caption.trim();caption=caption.ss(1,caption.length-1);result.caption=entag('center',entag('div',caption,protect('class="imagecaption"')));return''});var diagramSVG=diagramToSVG(result.diagramString,result.alignmentHint);var captionAbove=option('captionAbove','diagram')
			return result.beforeString+(result.caption&&captionAbove?result.caption:'')+diagramSVG+(result.caption&&!captionAbove?result.caption:'')+'\n'+replaceDiagrams(result.afterString)}else{return str}}
		var stylizeFence=function(cssClass,symbol){var pattern=new RegExp('\n([ \\t]*)'+symbol+'{3,}([ \\t]*\\S*)([ \\t]+.+)?\n([\\s\\S]+?)\n\\1'+symbol+'{3,}[ \t]*\n([ \\t]*\\[.+(?:\n.+){0,3}\\])?','g');str=str.rp(pattern,function(match,indent,lang,cssSubClass,sourceCode,caption){if(caption){caption=caption.trim();caption='<div '+protect('class="listingcaption '+cssClass+'"')+'>'+caption.ss(1,caption.length-1)+'</div>\n'}
			lang=lang?lang.trim():lang;lang=lang?[lang]:undefined;sourceCode=sourceCode.rp(new RegExp('(^|\n)'+indent,'g'),'$1');var captionAbove=option('captionAbove','listing')
			var nextSourceCode,nextLang,nextCssSubClass;var body='';do{nextSourceCode=nextLang=nextCssSubClass=undefined;sourceCode=sourceCode.rp(new RegExp('\\n([ \\t]*)'+symbol+'{3,}([ \\t]*\\S+)([ \\t]+.+)?\n([\\s\\S]*)'),function(match,indent,lang,cssSubClass,everythingElse){nextLang=[lang];nextCssSubClass=cssSubClass;nextSourceCode=everythingElse;return''});var highlighted=hljs.highlightAuto(sourceCode,lang).value;if(cssSubClass){highlighted=entag('div',highlighted,'class="'+cssSubClass+'"')}
				body+=highlighted;sourceCode=nextSourceCode;lang=nextLang;cssSubClass=nextCssSubClass}while(sourceCode);return'\n'+indent+'</p>'+(caption&&captionAbove?caption:'')+protect(entag('pre',entag('code',body),'class="listing '+cssClass+'"'))+(caption&&!captionAbove?caption:'')+'<p>\n'})};stylizeFence('tilde','~');stylizeFence('backtick','`');str=str.rp(/(<code\b.*?<\/code>)/gi,protector);str=str.rp(/<!--\s[\s\S]+?\s-->/g,'');str=replaceDiagrams(str);str=str.rp(/<svg( .*?)?>([\s\S]*?)<\/svg>/gi,function(match,attribs,body){return'<svg'+protect(attribs)+'>'+protect(body)+'</svg>'});str=str.rp(/<style>([\s\S]*?)<\/style>/gi,function(match,body){return entag('style',protect(body))});str=str.rp(/<img\s+src=(["'])[\s\S]*?\1\s*>/gi,function(match,quote){return"<img "+protect(match.ss(5,match.length-1))+">"});str=str.rp(/(`)(.+?(?:\n.+?)?)`(?!\d)/g,entag('code','$2'));str=str.rp(/(<code(?: .*?)?>)([\s\S]*?)<\/code>/gi,function(match,open,inlineCode){return protect(open+escapeHTMLEntities(inlineCode)+'</code>')});str=str.rp(/(<pre\b[\s\S]*?<\/pre>)/gi,protector);str=str.rp(/(<\w[^ \n<>]*?[ \t]+)(.*?)(?=\/?>)/g,protectorWithPrefix);str=str.rp(/(\$\$[\s\S]+?\$\$)/g,protector);str=str.rp(/((?:[^\w\d]))\$(\S(?:[^\$]*?\S(?!US|Can))??)\$(?![\w\d])/g,'$1\\($2\\)');str=str.rp(/((?:[^\w\d]))\$([ \t][^\$]+?[ \t])\$(?![\w\d])/g,'$1\\($2\\)');str=str.rp(/(\\\([\s\S]+?\\\))/g,protector);str=str.rp(/(\\begin\{equation\}[\s\S]*?\\end\{equation\})/g,protector);str=str.rp(/(\\begin\{eqnarray\}[\s\S]*?\\end\{eqnarray\})/g,protector);str=str.rp(/(\\begin\{equation\*\}[\s\S]*?\\end\{equation\*\})/g,protector);str=str.rp(/(?:^|\s*\n)(.+?)\n[ \t]*={3,}[ \t]*\n/g,makeHeaderFunc(1));str=str.rp(/(?:^|\s*\n)(.+?)\n[ \t]*-{3,}[ \t]*\n/g,makeHeaderFunc(2));for(var i=6;i>0;--i){str=str.rp(new RegExp(/^\s*/.source+'#{'+i+','+i+'}(?:[ \t])([^\n#]+)#*[ \t]*\n','gm'),makeHeaderFunc(i));str=str.rp(new RegExp(/^\s*/.source+'\\(#{'+i+','+i+'}\\)(?:[ \t])([^\n#]+)\\(?#*\\)?\\n[ \t]*\n','gm'),'\n</p>\n'+entag('div','$1',protect('class="nonumberh'+i+'"'))+'\n<p>\n\n')}
		str=str.rp(/\n[ \t]*((\*|-|_)[ \t]*){3,}[ \t]*\n/g,'\n<hr/>\n');str=str.rp(/\n[ \t]*\+{5,}[ \t]*\n/g,'\n<hr '+protect('class="pagebreak"')+'/>\n');str=str.rp(/^!!![ \t]*([^\s"'><&\:]*)\:?(.*)\n([ \t]{3,}.*\s*\n)*/gm,function(match,cssClass,title){match=match.trim();return'\n\n'+entag('div',((title?entag('div',title,protect('class="admonition-title"'))+'\n':'')+match.ss(match.indexOf('\n'))).trim(),protect('class="admonition '+cssClass.toLowerCase().trim()+'"'))+'\n\n'});var FANCY_QUOTE=protect('class="fancyquote"');str=str.rp(/\n>[ \t]*"(.*(?:\n>.*)*)"[ \t]*(?:\n>[ \t]*)?(\n>[ \t]{2,}\S.*)?\n/g,function(match,quote,author){return entag('blockquote',entag('span',quote.rp(/\n>/g,'\n'),FANCY_QUOTE)+(author?entag('span',author.rp(/\n>/g,'\n'),protect('class="author"')):''),FANCY_QUOTE)});var foundBlockquote=!1;do{foundBlockquote=!1;str=str.rp(/(?:\n>.*){2,}/g,function(match){foundBlockquote=!0;return entag('blockquote',match.rp(/\n>/g,'\n'))})}while(foundBlockquote);str=str.rp(/\s*\[\^(\S+)\](?!:)/g,function(match,symbolicName){symbolicName=symbolicName.toLowerCase().trim();if(!(symbolicName in endNoteTable)){++endNoteCount;endNoteTable[symbolicName]=endNoteCount}
			return'<sup><a '+protect('href="#endnote-'+symbolicName+'"')+'>'+endNoteTable[symbolicName]+'</a></sup>'});str=str.rp(/\[#([^\)\(\[\]\.#\s]+)\](?!:)/g,function(match,symbolicName){symbolicName=symbolicName.trim();return'[<a '+protect('href="#citation-'+symbolicName.toLowerCase()+'"')+'>'+symbolicName+'</a>]'});str=str.rp(/\n\[#(\S+)\]:[ \t]+((?:[ \t]*\S[^\n]*\n?)*)/g,function(match,symbolicName,entry){symbolicName=symbolicName.trim();return'<div '+protect('class="bib"')+'>[<a '+protect('class="target" name="citation-'+symbolicName.toLowerCase()+'"')+'>&nbsp;</a><b>'+symbolicName+'</b>] '+entry+'</div>'});str=replaceTables(str,protect);str=str.rp(/^\[([^\^#].*?)\]:(.*?)$/gm,function(match,symbolicName,url){referenceLinkTable[symbolicName.toLowerCase().trim()]={link:url.trim(),used:!1};return''});str=str.rp(/(?:<|(?!<)\b)(\S+@(\S+\.)+?\S{2,}?)(?:$|>|(?=<)|(?=\s)(?!>))/g,function(match,addr){return'<a '+protect('href="mailto:'+addr+'"')+'>'+addr+'</a>'});var formatImage=function(ignore,url,attribs){attribs=attribs||'';var img;var hash;if(/(.mp4|.m4v|.avi|.mpg|.mov)$/i.test(url)){img='<video '+protect('class="markdeep" src="'+url+'"'+attribs+' width="480px" controls="true"')+'/>'}else if(hash=url.match(/^https:\/\/(?:www\.)?(?:youtube\.com\/\S*?v=|youtu\.be\/)([\w\d-]+)(&.*)?$/i)){img='<iframe '+protect('class="markdeep" src="https://www.youtube.com/embed/'+hash[1]+'"'+attribs+' width="480px" height="300px" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen')+'></iframe>'}else if(hash=url.match(/^https:\/\/(?:www\.)?vimeo.com\/\S*?\/([\w\d-]+)$/i)){img='<iframe '+protect('class="markdeep" src="https://player.vimeo.com/video/'+hash[1]+'"'+attribs+' width="480px" height="300px" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen')+'></iframe>'}else{img='<img '+protect('class="markdeep" src="'+url+'"'+attribs)+' />';img=entag('a ',img,protect('href="'+url+'" target="_blank"'))}
			return img};str=str.rp(/\b(figure|fig\.|table|tbl\.|listing|lst\.)\s*\[([^\s\]]+)\](?=\()/gi,function(match){return match+'<span/>'});str=str.rp(/\(http:\/\/g.gravizo.com\/(.*g)\?((?:[^\(\)]|\([^\(\)]*\))*)\)/gi,function(match,protocol,url){return"(http://g.gravizo.com/"+protocol+"?"+encodeURIComponent(url)+")"});str=str.rp(/(^|[^!])\[([^\[\]]+?)\]\(("?)([^<>\s"]+?)\3(\s+[^\)]*?)?\)/g,function(match,pre,text,maybeQuote,url,attribs){attribs=attribs||'';return pre+'<a '+protect('href="'+url+'"'+attribs)+'>'+text+'</a>'+maybeShowLabel(url)});str=str.rp(/(^|[^!])\[[ \t]*?\]\(("?)([^<>\s"]+?)\2\)/g,function(match,pre,maybeQuote,url){return pre+'<a '+protect('href="'+url+'"')+'>'+url+'</a>'});var imageGridAttribs=protect('width="100%"');var imageGridRowAttribs=protect('valign="top"');str=str.rp(/(?:\n(?:[ \t]*!\[[^\n]*?\]\(("?)[^<>\s]+?(?:[^\n\)]*?)?\)){2,}[ \t]*)+\n/g,function(match){var table='';match=match.split('\n');match.forEach(function(row){row=row.trim();if(row){table+=entag('tr',row.rp(/[ \t]*!\[[^\n]*?\]\([^\)\s]+([^\)]*?)?\)/g,function(image,attribs){return entag('td','\n\n'+image+'\n\n')}),imageGridRowAttribs)}});return'\n'+entag('table',table,imageGridAttribs)+'\n'});str=str.rp(/(\s*)!\[\]\(("?)([^"<>\s]+?)\2(\s[^\)]*?)?\)(\s*)/g,function(match,preSpaces,maybeQuote,url,attribs,postSpaces){var img=formatImage(match,url,attribs);if(isolated(preSpaces,postSpaces)){img=entag('center',img)}
			return preSpaces+img+postSpaces});var loop=!0;var imageCaptionAbove=option('captionAbove','image');while(loop){loop=!1;str=str.rp(/(\s*)!\[([\s\S]+?)?\]\(("?)([^"<>\s]+?)\3(\s[^\)]*?)?\)(\s*)/,function(match,preSpaces,caption,maybeQuote,url,attribs,postSpaces){loop=!0;var divStyle='';var iso=isolated(preSpaces,postSpaces);if(attribs&&!iso){attribs=attribs.rp(/((?:max-)?width)\s*:\s*[^;'"]*/g,function(attribMatch,attrib){divStyle=attribMatch+';';return attrib+':100%'});attribs=attribs.rp(/((?:max-)?width)\s*=\s*('\S+?'|"\S+?")/g,function(attribMatch,attrib,expr){divStyle=attrib+':'+expr.ss(1,expr.length-1)+';';return'style="'+attrib+':100%" '})}
			var img=formatImage(match,url,attribs);if(iso){preSpaces+='<center>';postSpaces='</center>'+postSpaces}else{divStyle+='float:right;margin:4px 0px 0px 25px;'}
			caption=entag('div',caption+maybeShowLabel(url),protect('class="imagecaption"'));return preSpaces+entag('div',(imageCaptionAbove?caption:'')+img+(!imageCaptionAbove?caption:''),protect('class="image" style="'+divStyle+'"'))+postSpaces})}
		str=replaceMatched(str,/\*\*/,'strong',protect('class="asterisk"'));str=replaceMatched(str,/__/,'strong',protect('class="underscore"'));str=replaceMatched(str,/\*/,'em',protect('class="asterisk"'));str=replaceMatched(str,/_/,'em',protect('class="underscore"'));str=str.rp(/\~\~([^~].*?)\~\~/g,entag('del','$1'));str=str.rp(/(^|[ \t->])(")(?=\w)/gm,'$1'+keyword('&ldquo;'));str=str.rp(/([A-Za-z\.,:;\?!=<])(")(?=$|\W)/gm,'$1'+keyword('&rdquo;'));str=str.rp(/(\s|^)<==(\s)/g,'$1\u21D0$2');str=str.rp(/(\s|^)->(\s)/g,'$1&rarr;$2');str=str.rp(/(\s|^)-->(\s)/g,'$1&xrarr;$2');str=str.rp(/(\s|^)==>(\s)/g,'$1\u21D2$2');str=str.rp(/(\s|^)<-(\s)/g,'$1&larr;$2');str=str.rp(/(\s|^)<--(\s)/g,'$1&xlarr;$2');str=str.rp(/(\s|^)<==>(\s)/g,'$1\u21D4$2');str=str.rp(/(\s|^)<->(\s)/g,'$1\u2194$2');str=str.rp(/([^-!\:\|])---([^->\:\|])/g,'$1&mdash;$2');str=str.rp(/([^-!\:\|])--([^->\:\|])/g,'$1&mdash;$2');str=str.rp(/(\d+\s?)x(\s?\d+)/g,'$1&times;$2');str=str.rp(/([\s\(\[<\|])-(\d)/g,'$1&minus;$2');str=str.rp(/(\d) - (\d)/g,'$1 &minus; $2');str=str.rp(/\^([-+]?\d+)\b/g,'<sup>$1</sup>');str=str.rp(/(^|\s|\b)\\(pagebreak|newpage)(\b|\s|$)/gi,protect('<div style="page-break-after:always"> </div>\n'))
		str=replaceScheduleLists(str,protect);str=replaceDefinitionLists(str,protect);str=replaceLists(str,protect);str=str.rp(/(\d+?)[ \t-]degree(?:s?)/g,'$1&deg;');str=str.rp(/(?:<p>)?\n\s*\n+(?!<\/p>)/gi,function(match){return(/^<p>/i.test(match))?match:'\n\n</p><p>\n\n'});str=str.rp(/<p>[\s\n]*<\/p>/gi,'');str=str.rp(/(^|[^!])\[([^\[\]]+?)\]\[(.*?)\]/g,function(match,pre,text,symbolicName){if(!symbolicName.trim()){symbolicName=text}
			symbolicName=symbolicName.toLowerCase().trim();var t=referenceLinkTable[symbolicName];if(!t){console.log("Reference link '"+symbolicName+"' never defined");return'?'}else{t.used=!0;return pre+'<a '+protect('href="'+t.link+'"')+'>'+text+'</a>'}});str=str.rp(/\n\[\^(\S+)\]: ((?:.+?\n?)*)/g,function(match,symbolicName,note){symbolicName=symbolicName.toLowerCase().trim();if(symbolicName in endNoteTable){return'\n<div '+protect('class="endnote"')+'><a '+protect('class="target" name="endnote-'+symbolicName+'"')+'>&nbsp;</a><sup>'+endNoteTable[symbolicName]+'</sup> '+note+'</div>'}else{return"\n"}});var allHeaders=str.match(/<h([1-6])>(.*?)<\/h\1>/gi);if(allHeaders){allHeaders.forEach(function(header){header=removeHTMLTags(header.ss(4,header.length-5)).trim();var link='<a '+protect('href="#'+mangle(header)+'"')+'>';str=str.rp(RegExp("(\\b"+escapeRegExpCharacters(header)+")(?=\\s"+keyword('subsection')+"|\\s"+keyword('section')+")",'gi'),link+"$1</a>")})}
		var refCounter={};var refTable={};str=str.rp(RegExp(/($|>)\s*/.source+'('+keyword('figure')+'|'+keyword('table')+'|'+keyword('listing')+'|'+keyword('diagram')+')'+/\s+\[(.+?)\]:/.source,'gim'),function(match,prefix,_type,_ref){var type=_type.toLowerCase();var count=refCounter[type]=(refCounter[type]|0)+1;var ref=type+'_'+mangle(_ref.toLowerCase().trim());refTable[ref]={number:count,used:!1,source:type+' ['+_ref+']'};return prefix+entag('a','&nbsp;',protect('class="target" name="'+ref+'"'))+entag('b',type[0].toUpperCase()+type.ss(1)+'&nbsp;'+count+':',protect('style="font-style:normal;"'))+maybeShowLabel(_ref)});str=str.rp(RegExp('\\b(fig\\.|tbl\\.|lst\\.|'+keyword('figure')+'|'+keyword('table')+'|'+keyword('listing')+'|'+keyword('diagram')+')\\s+\\[([^\\s\\]]+)\\]','gi'),function(match,_type,_ref){var type=_type.toLowerCase();switch(type){case 'fig.':type=keyword('figure').toLowerCase();break;case 'tbl.':type=keyword('table').toLowerCase();break;case 'lst.':type=keyword('listing').toLowerCase();break}
			var ref=type+'_'+mangle(_ref.toLowerCase().trim());var t=refTable[ref];if(t){t.used=!0;return'<a '+protect('href="#'+ref+'"')+'>'+_type+'&nbsp;'+t.number+maybeShowLabel(_ref)+'</a>'}else{console.log("Reference to undefined '"+type+" ["+_ref+"]'");return _type+' ?'}});str=str.rp(/(?:<|(?!<)\b)(\w{3,6}:\/\/.+?)(?:$|>|(?=<)|(?=\s|\u00A0)(?!<))/g,function(match,url){var extra='';if(url[url.length-1]=='.'){url=url.ss(0,url.length-1);extra='.'}
			return'<a '+((url[0]!=='s'&&url[0]!=='p')?protect('href="'+url+'" class="url"'):'')+'>'+url+'</a>'+extra});if(!elementMode){var TITLE_PATTERN=/^\s*(?:<\/p><p>)?\s*<strong.*?>([^ \t\*].*?[^ \t\*])<\/strong>(?:<\/p>)?[ \t]*\n/.source;var ALL_SUBTITLES_PATTERN=/([ {4,}\t][ \t]*\S.*\n)*/.source;str=str.rp(new RegExp(TITLE_PATTERN+ALL_SUBTITLES_PATTERN,'g'),function(match,title){title=title.trim();var subtitles=match.ss(match.indexOf('\n',match.indexOf('</strong>')));subtitles=subtitles?subtitles.rp(/[ \t]*(\S.*?)\n/g,'<div class="subtitle"> $1 </div>\n'):'';return entag('title',removeHTMLTags(title))+maybeShowLabel(window.location.href,'center')+'<div class="title"> '+title+' </div>\n'+subtitles+'<div class="afterTitles"></div>\n'})}
		str=str.rp(/^\s*<\/p>/,'');if(!elementMode){var temp=insertTableOfContents(str,protect);str=temp[0];var toc=temp[1];str=str.rp(RegExp('\\b('+keyword('sec')+'\\.|'+keyword('section')+'|'+keyword('subsection')+')\\s\\[(.+?)\\]','gi'),function(match,prefix,ref){var link=toc[ref.toLowerCase().trim()];if(link){return prefix+'  <a '+protect('href="#toc'+link+'"')+'>'+link+'</a>'}else{return prefix+' ?'}})}
		while(str.indexOf(PROTECT_CHARACTER)+1){str=str.rp(PROTECT_REGEXP,expose)}
		Object.keys(referenceLinkTable).forEach(function(key){if(!referenceLinkTable[key].used){console.log("Reference link '["+key+"]' is defined but never used")}});Object.keys(refTable).forEach(function(key){if(!refTable[key].used){console.log("'"+refTable[key].source+"' is never referenced")}});return'<span class="md">'+entag('p',str)+'</span>'}
	function strToArray(s){if(Array.from){return Array.from(s)}else{var a=[];for(var i=0;i<s.length;++i){a[i]=s[i]}
		return a}}
	function equalizeLineLengths(str){var lineArray=str.split('\n');var longest=0;lineArray.forEach(function(line){longest=max(longest,strToArray(line).length)});var spaces=Array(longest+1).join(' ');var result='';lineArray.forEach(function(line){result+=line+spaces.ss(strToArray(line).length)+'\n'});return result}
	function removeLeadingSpace(str){var lineArray=str.split('\n');var minimum=Infinity;lineArray.forEach(function(line){if(line.trim()!==''){var spaceArray=line.match(/^([ \t]*)/);if(spaceArray){minimum=min(minimum,spaceArray[0].length)}}});if(minimum===0){return str}
		var result='';lineArray.forEach(function(line){result+=line.ss(minimum)+'\n'});return result}
	function isASCIILetter(c){var code=c.charCodeAt(0);return((code>=65)&&(code<=90))||((code>=97)&&(code<=122))}
	function diagramToSVG(diagramString,alignmentHint){diagramString=equalizeLineLengths(diagramString);var HIDE_O='\ue004';diagramString=diagramString.rp(/([a-zA-Z]{2})o/g,'$1'+HIDE_O);diagramString=diagramString.rp(/o([a-zA-Z]{2})/g,HIDE_O+'$1');diagramString=diagramString.rp(/([a-zA-Z\ue004])o([a-zA-Z\ue004])/g,'$1'+HIDE_O+'$2');var SCALE=8;var ASPECT=2;var DIAGONAL_ANGLE=Math.atan(1.0/ASPECT)*180/Math.PI;var EPSILON=1e-6;var ARROW_HEAD_CHARACTERS='>v<^';var POINT_CHARACTERS='o*';var JUMP_CHARACTERS='()';var UNDIRECTED_VERTEX_CHARACTERS="+";var VERTEX_CHARACTERS=UNDIRECTED_VERTEX_CHARACTERS+".'";var GRAY_CHARACTERS='\u2591\u2592\u2593\u2594\u2589';var TRI_CHARACTERS='\u25E2\u25E3\u25E4\u25E5';var DECORATION_CHARACTERS=ARROW_HEAD_CHARACTERS+POINT_CHARACTERS+JUMP_CHARACTERS+GRAY_CHARACTERS+TRI_CHARACTERS;function isUndirectedVertex(c){return UNDIRECTED_VERTEX_CHARACTERS.indexOf(c)+1}
		function isVertex(c){return VERTEX_CHARACTERS.indexOf(c)!==-1}
		function isTopVertex(c){return isUndirectedVertex(c)||(c==='.')}
		function isBottomVertex(c){return isUndirectedVertex(c)||(c==="'")}
		function isVertexOrLeftDecoration(c){return isVertex(c)||(c==='<')||isPoint(c)}
		function isVertexOrRightDecoration(c){return isVertex(c)||(c==='>')||isPoint(c)}
		function isArrowHead(c){return ARROW_HEAD_CHARACTERS.indexOf(c)+1}
		function isGray(c){return GRAY_CHARACTERS.indexOf(c)+1}
		function isTri(c){return TRI_CHARACTERS.indexOf(c)+1}
		function isSolidHLine(c){return(c==='-')||isUndirectedVertex(c)||isJump(c)}
		function isSolidVLineOrJumpOrPoint(c){return isSolidVLine(c)||isJump(c)||isPoint(c)}
		function isSolidVLine(c){return(c==='|')||isUndirectedVertex(c)}
		function isSolidDLine(c){return(c==='/')||isUndirectedVertex(c)}
		function isSolidBLine(c){return(c==='\\')||isUndirectedVertex(c)}
		function isJump(c){return JUMP_CHARACTERS.indexOf(c)+1}
		function isPoint(c){return POINT_CHARACTERS.indexOf(c)+1}
		function isDecoration(c){return DECORATION_CHARACTERS.indexOf(c)+1}
		function isEmpty(c){return c===' '}
		function Vec2(x,y){if(!(this instanceof Vec2)){return new Vec2(x,y)}
			if(y===undefined){if(x===undefined){x=y=0}
			else if(x instanceof Vec2){y=x.y;x=x.x}
			else{console.error("Vec2 requires one Vec2 or (x, y) as an argument")}}
			this.x=x;this.y=y;Object.seal(this)}
		Vec2.prototype.toString=Vec2.prototype.toSVG=function(){return''+(this.x*SCALE)+','+(this.y*SCALE*ASPECT)+' '};function makeGrid(str){var grid=function(x,y){if(y===undefined){if(x instanceof Vec2){y=x.y;x=x.x}
		else{console.error('grid requires either a Vec2 or (x, y)')}}
			return((x>=0)&&(x<grid.width)&&(y>=0)&&(y<grid.height))?str[y*(grid.width+1)+x]:' '};grid._used=[];grid.height=str.split('\n').length;if(str[str.length-1]==='\n'){--grid.height}
			str=strToArray(str);grid.width=str.indexOf('\n');grid.setUsed=function(x,y){if(y===undefined){if(x instanceof Vec2){y=x.y;x=x.x}
			else{console.error('grid requires either a Vec2 or (x, y)')}}
				if((x>=0)&&(x<grid.width)&&(y>=0)&&(y<grid.height)){grid._used[y*(grid.width+1)+x]=!0}};grid.isUsed=function(x,y){if(y===undefined){if(x instanceof Vec2){y=x.y;x=x.x}
			else{console.error('grid requires either a Vec2 or (x, y)')}}
				return(this._used[y*(this.width+1)+x]===!0)};grid.isSolidVLineAt=function(x,y){if(y===undefined){y=x.x;x=x.x}
				var up=grid(x,y-1);var c=grid(x,y);var dn=grid(x,y+1);var uprt=grid(x+1,y-1);var uplt=grid(x-1,y-1);if(isSolidVLine(c)){return(isTopVertex(up)||(up==='^')||isSolidVLine(up)||isJump(up)||isBottomVertex(dn)||(dn==='v')||isSolidVLine(dn)||isJump(dn)||isPoint(up)||isPoint(dn)||(grid(x,y-1)==='_')||(uplt==='_')||(uprt==='_')||((isTopVertex(uplt)||isTopVertex(uprt))&&(isBottomVertex(grid(x-1,y+1))||isBottomVertex(grid(x+1,y+1)))))}else if(isTopVertex(c)||(c==='^')){return isSolidVLine(dn)||(isJump(dn)&&(c!=='.'))}else if(isBottomVertex(c)||(c==='v')){return isSolidVLine(up)||(isJump(up)&&(c!=="'"))}else if(isPoint(c)){return isSolidVLine(up)||isSolidVLine(dn)}
				return!1};grid.isSolidHLineAt=function(x,y){if(y===undefined){y=x.x;x=x.x}
				var ltlt=grid(x-2,y);var lt=grid(x-1,y);var c=grid(x+0,y);var rt=grid(x+1,y);var rtrt=grid(x+2,y);if(isSolidHLine(c)||(isSolidHLine(lt)&&isJump(c))){if(isSolidHLine(lt)){return isSolidHLine(rt)||isVertexOrRightDecoration(rt)||isSolidHLine(ltlt)||isVertexOrLeftDecoration(ltlt)}else if(isVertexOrLeftDecoration(lt)){return isSolidHLine(rt)}else{return isSolidHLine(rt)&&(isSolidHLine(rtrt)||isVertexOrRightDecoration(rtrt))}}else if(c==='<'){return isSolidHLine(rt)&&isSolidHLine(rtrt)}else if(c==='>'){return isSolidHLine(lt)&&isSolidHLine(ltlt)}else if(isVertex(c)){return((isSolidHLine(lt)&&isSolidHLine(ltlt))||(isSolidHLine(rt)&&isSolidHLine(rtrt)))}
				return!1};grid.isSolidBLineAt=function(x,y){if(y===undefined){y=x.x;x=x.x}
				var c=grid(x,y);var lt=grid(x-1,y-1);var rt=grid(x+1,y+1);if(c==='\\'){return(isSolidBLine(rt)||isBottomVertex(rt)||isPoint(rt)||(rt==='v')||isSolidBLine(lt)||isTopVertex(lt)||isPoint(lt)||(lt==='^')||(grid(x,y-1)==='/')||(grid(x,y+1)==='/')||(rt==='_')||(lt==='_'))}else if(c==='.'){return(rt==='\\')}else if(c==="'"){return(lt==='\\')}else if(c==='^'){return rt==='\\'}else if(c==='v'){return lt==='\\'}else if(isVertex(c)||isPoint(c)||(c==='|')){return isSolidBLine(lt)||isSolidBLine(rt)}};grid.isSolidDLineAt=function(x,y){if(y===undefined){y=x.x;x=x.x}
				var c=grid(x,y);var lt=grid(x-1,y+1);var rt=grid(x+1,y-1);if(c==='/'&&((grid(x,y-1)==='\\')||(grid(x,y+1)==='\\'))){return!0}else if(isSolidDLine(c)){return(isSolidDLine(rt)||isTopVertex(rt)||isPoint(rt)||(rt==='^')||(rt==='_')||isSolidDLine(lt)||isBottomVertex(lt)||isPoint(lt)||(lt==='v')||(lt==='_'))}else if(c==='.'){return(lt==='/')}else if(c==="'"){return(rt==='/')}else if(c==='^'){return lt==='/'}else if(c==='v'){return rt==='/'}else if(isVertex(c)||isPoint(c)||(c==='|')){return isSolidDLine(lt)||isSolidDLine(rt)}
				return!1};grid.toString=function(){return str};return Object.freeze(grid)}
		function Path(A,B,C,D,dashed){if(!((A instanceof Vec2)&&(B instanceof Vec2))){console.error('Path constructor requires at least two Vec2s')}
			this.A=A;this.B=B;if(C){this.C=C;if(D){this.D=D}else{this.D=C}}
			this.dashed=dashed||!1;Object.freeze(this)}
		var _=Path.prototype;_.isVertical=function(){return this.B.x===this.A.x};_.isHorizontal=function(){return this.B.y===this.A.y};_.isDiagonal=function(){var dx=this.B.x-this.A.x;var dy=this.B.y-this.A.y;return(abs(dy+dx)<EPSILON)};_.isBackDiagonal=function(){var dx=this.B.x-this.A.x;var dy=this.B.y-this.A.y;return(abs(dy-dx)<EPSILON)};_.isCurved=function(){return this.C!==undefined};_.endsAt=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return((this.A.x===x)&&(this.A.y===y))||((this.B.x===x)&&(this.B.y===y))};_.upEndsAt=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return this.isVertical()&&(this.A.x===x)&&(min(this.A.y,this.B.y)===y)};_.diagonalUpEndsAt=function(x,y){if(!this.isDiagonal()){return!1}
			if(y===undefined){y=x.y;x=x.x}
			if(this.A.y<this.B.y){return(this.A.x===x)&&(this.A.y===y)}else{return(this.B.x===x)&&(this.B.y===y)}};_.diagonalDownEndsAt=function(x,y){if(!this.isDiagonal()){return!1}
			if(y===undefined){y=x.y;x=x.x}
			if(this.B.y<this.A.y){return(this.A.x===x)&&(this.A.y===y)}else{return(this.B.x===x)&&(this.B.y===y)}};_.backDiagonalUpEndsAt=function(x,y){if(!this.isBackDiagonal()){return!1}
			if(y===undefined){y=x.y;x=x.x}
			if(this.A.y<this.B.y){return(this.A.x===x)&&(this.A.y===y)}else{return(this.B.x===x)&&(this.B.y===y)}};_.backDiagonalDownEndsAt=function(x,y){if(!this.isBackDiagonal()){return!1}
			if(y===undefined){y=x.y;x=x.x}
			if(this.B.y<this.A.y){return(this.A.x===x)&&(this.A.y===y)}else{return(this.B.x===x)&&(this.B.y===y)}};_.downEndsAt=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return this.isVertical()&&(this.A.x===x)&&(max(this.A.y,this.B.y)===y)};_.leftEndsAt=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return this.isHorizontal()&&(this.A.y===y)&&(min(this.A.x,this.B.x)===x)};_.rightEndsAt=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return this.isHorizontal()&&(this.A.y===y)&&(max(this.A.x,this.B.x)===x)};_.verticalPassesThrough=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return this.isVertical()&&(this.A.x===x)&&(min(this.A.y,this.B.y)<=y)&&(max(this.A.y,this.B.y)>=y)}
		_.horizontalPassesThrough=function(x,y){if(y===undefined){y=x.y;x=x.x}
			return this.isHorizontal()&&(this.A.y===y)&&(min(this.A.x,this.B.x)<=x)&&(max(this.A.x,this.B.x)>=x)}
		_.toSVG=function(){var svg='<path d="M '+this.A;if(this.isCurved()){svg+='C '+this.C+this.D+this.B}else{svg+='L '+this.B}
			svg+='" style="fill:none;"';if(this.dashed){svg+=' stroke-dasharray="3,6"'}
			svg+='/>';return svg};function PathSet(){this._pathArray=[]}
		var PS=PathSet.prototype;PS.insert=function(path){this._pathArray.push(path)};function makeFilterAny(method){return function(x,y){for(var i=0;i<this._pathArray.length;++i){if(method.call(this._pathArray[i],x,y)){return!0}}}}
		PS.upEndsAt=makeFilterAny(_.upEndsAt);PS.diagonalUpEndsAt=makeFilterAny(_.diagonalUpEndsAt);PS.backDiagonalUpEndsAt=makeFilterAny(_.backDiagonalUpEndsAt);PS.diagonalDownEndsAt=makeFilterAny(_.diagonalDownEndsAt);PS.backDiagonalDownEndsAt=makeFilterAny(_.backDiagonalDownEndsAt);PS.downEndsAt=makeFilterAny(_.downEndsAt);PS.leftEndsAt=makeFilterAny(_.leftEndsAt);PS.rightEndsAt=makeFilterAny(_.rightEndsAt);PS.endsAt=makeFilterAny(_.endsAt);PS.verticalPassesThrough=makeFilterAny(_.verticalPassesThrough);PS.horizontalPassesThrough=makeFilterAny(_.horizontalPassesThrough);PS.toSVG=function(){var svg='';for(var i=0;i<this._pathArray.length;++i){svg+=this._pathArray[i].toSVG()+'\n'}
			return svg};function DecorationSet(){this._decorationArray=[]}
		var DS=DecorationSet.prototype;DS.insert=function(x,y,type,angle){if(type===undefined){type=y;y=x.y;x=x.x}
			if(!isDecoration(type)){console.error('Illegal decoration character: '+type)}
			var d={C:Vec2(x,y),type:type,angle:angle||0};if(isPoint(type)){this._decorationArray.push(d)}else{this._decorationArray.unshift(d)}};DS.toSVG=function(){var svg='';for(var i=0;i<this._decorationArray.length;++i){var decoration=this._decorationArray[i];var C=decoration.C;if(isJump(decoration.type)){var dx=(decoration.type===')')?+0.75:-0.75;var up=Vec2(C.x,C.y-0.5);var dn=Vec2(C.x,C.y+0.5);var cup=Vec2(C.x+dx,C.y-0.5);var cdn=Vec2(C.x+dx,C.y+0.5);svg+='<path d="M '+dn+' C '+cdn+cup+up+'" style="fill:none;"/>'}else if(isPoint(decoration.type)){svg+='<circle cx="'+(C.x*SCALE)+'" cy="'+(C.y*SCALE*ASPECT)+'" r="'+(SCALE-STROKE_WIDTH)+'" class="'+((decoration.type==='*')?'closed':'open')+'dot"/>'}else if(isGray(decoration.type)){var shade=Math.round((3-GRAY_CHARACTERS.indexOf(decoration.type))*63.75);svg+='<rect x="'+((C.x-0.5)*SCALE)+'" y="'+((C.y-0.5)*SCALE*ASPECT)+'" width="'+SCALE+'" height="'+(SCALE*ASPECT)+'" stroke=none fill="rgb('+shade+','+shade+','+shade+')"/>'}else if(isTri(decoration.type)){var index=TRI_CHARACTERS.indexOf(decoration.type);var xs=0.5-(index&1);var ys=0.5-(index>>1);xs*=sign(ys);var tip=Vec2(C.x+xs,C.y-ys);var up=Vec2(C.x+xs,C.y+ys);var dn=Vec2(C.x-xs,C.y+ys);svg+='<polygon points="'+tip+up+dn+'" style="stroke:none"/>\n'}else{var tip=Vec2(C.x+1,C.y);var up=Vec2(C.x-0.5,C.y-0.35);var dn=Vec2(C.x-0.5,C.y+0.35);svg+='<polygon points="'+tip+up+dn+'"  style="stroke:none" transform="rotate('+decoration.angle+','+C+')"/>\n'}}
			return svg};function findPaths(grid,pathSet){function lineContains(A,B,c){var dx=sign(B.x-A.x);var dy=sign(B.y-A.y);var x,y;for(x=A.x,y=A.y;(x!==B.x)||(y!==B.y);x+=dx,y+=dy){if(grid(x,y)===c){return!0}}
			return(grid(x,y)===c)}
			for(var x=0;x<grid.width;++x){for(var y=0;y<grid.height;++y){if(grid.isSolidVLineAt(x,y)){var A=Vec2(x,y);do{grid.setUsed(x,y);++y}while(grid.isSolidVLineAt(x,y));var B=Vec2(x,y-1);var up=grid(A);var upup=grid(A.x,A.y-1);if(!isVertex(up)&&((upup==='-')||(upup==='_')||(grid(A.x-1,A.y-1)==='_')||(grid(A.x+1,A.y-1)==='_')||isBottomVertex(upup))||isJump(upup)){A.y-=0.5}
				var dn=grid(B);var dndn=grid(B.x,B.y+1);if(!isVertex(dn)&&((dndn==='-')||isTopVertex(dndn))||isJump(dndn)||(grid(B.x-1,B.y)==='_')||(grid(B.x+1,B.y)==='_')){B.y+=0.5}
				if((A.x!==B.x)||(A.y!==B.y)){pathSet.insert(new Path(A,B))}}
			else if((grid(x,y)==="'")&&(((grid(x-1,y)==='-')&&(grid(x+1,y-1)==='_')&&!isSolidVLineOrJumpOrPoint(grid(x-1,y-1)))||((grid(x-1,y-1)==='_')&&(grid(x+1,y)==='-')&&!isSolidVLineOrJumpOrPoint(grid(x+1,y-1))))){pathSet.insert(new Path(Vec2(x,y-0.5),Vec2(x,y)))}
			else if((grid(x,y)==='.')&&(((grid(x-1,y)==='_')&&(grid(x+1,y)==='-')&&!isSolidVLineOrJumpOrPoint(grid(x+1,y+1)))||((grid(x-1,y)==='-')&&(grid(x+1,y)==='_')&&!isSolidVLineOrJumpOrPoint(grid(x-1,y+1))))){pathSet.insert(new Path(Vec2(x,y),Vec2(x,y+0.5)))}}}
			for(var y=0;y<grid.height;++y){for(var x=0;x<grid.width;++x){if(grid.isSolidHLineAt(x,y)){var A=Vec2(x,y);do{grid.setUsed(x,y);++x}while(grid.isSolidHLineAt(x,y));var B=Vec2(x-1,y);if(!isVertex(grid(A.x-1,A.y))&&((isTopVertex(grid(A))&&isSolidVLineOrJumpOrPoint(grid(A.x-1,A.y+1)))||(isBottomVertex(grid(A))&&isSolidVLineOrJumpOrPoint(grid(A.x-1,A.y-1))))){++A.x}
				if(!isVertex(grid(B.x+1,B.y))&&((isTopVertex(grid(B))&&isSolidVLineOrJumpOrPoint(grid(B.x+1,B.y+1)))||(isBottomVertex(grid(B))&&isSolidVLineOrJumpOrPoint(grid(B.x+1,B.y-1))))){--B.x}
				if((A.x!==B.x)||(A.y!==B.y)){pathSet.insert(new Path(A,B))}}}}
			for(var i=-grid.height;i<grid.width;++i){for(var x=i,y=0;y<grid.height;++y,++x){if(grid.isSolidBLineAt(x,y)){var A=Vec2(x,y);do{++x;++y}while(grid.isSolidBLineAt(x,y));var B=Vec2(x-1,y-1);if(lineContains(A,B,'\\')){for(var j=A.x;j<=B.x;++j){grid.setUsed(j,A.y+(j-A.x))}
				var top=grid(A);var up=grid(A.x,A.y-1);var uplt=grid(A.x-1,A.y-1);if((up==='/')||(uplt==='_')||(up==='_')||(!isVertex(top)&&(isSolidHLine(uplt)||isSolidVLine(uplt)))){A.x-=0.5;A.y-=0.5}else if(isPoint(uplt)){A.x-=0.25;A.y-=0.25}
				var bottom=grid(B);var dnrt=grid(B.x+1,B.y+1);if((grid(B.x,B.y+1)==='/')||(grid(B.x+1,B.y)==='_')||(grid(B.x-1,B.y)==='_')||(!isVertex(grid(B))&&(isSolidHLine(dnrt)||isSolidVLine(dnrt)))){B.x+=0.5;B.y+=0.5}else if(isPoint(dnrt)){B.x+=0.25;B.y+=0.25}
				pathSet.insert(new Path(A,B))}}}}
			for(var i=-grid.height;i<grid.width;++i){for(var x=i,y=grid.height-1;y>=0;--y,++x){if(grid.isSolidDLineAt(x,y)){var A=Vec2(x,y);do{++x;--y}while(grid.isSolidDLineAt(x,y));var B=Vec2(x-1,y+1);if(lineContains(A,B,'/')){for(var j=A.x;j<=B.x;++j){grid.setUsed(j,A.y-(j-A.x))}
				var up=grid(B.x,B.y-1);var uprt=grid(B.x+1,B.y-1);var bottom=grid(B);if((up==='\\')||(up==='_')||(uprt==='_')||(!isVertex(grid(B))&&(isSolidHLine(uprt)||isSolidVLine(uprt)))){B.x+=0.5;B.y-=0.5}else if(isPoint(uprt)){B.x+=0.25;B.y-=0.25}
				var dnlt=grid(A.x-1,A.y+1);var top=grid(A);if((grid(A.x,A.y+1)==='\\')||(grid(A.x-1,A.y)==='_')||(grid(A.x+1,A.y)==='_')||(!isVertex(grid(A))&&(isSolidHLine(dnlt)||isSolidVLine(dnlt)))){A.x-=0.5;A.y+=0.5}else if(isPoint(dnlt)){A.x-=0.25;A.y+=0.25}
				pathSet.insert(new Path(A,B))}}}}
			for(var y=0;y<grid.height;++y){for(var x=0;x<grid.width;++x){var c=grid(x,y);if(isTopVertex(c)){if(isSolidHLine(grid(x-1,y))&&isSolidVLine(grid(x+1,y+1))){grid.setUsed(x-1,y);grid.setUsed(x,y);grid.setUsed(x+1,y+1);pathSet.insert(new Path(Vec2(x-1,y),Vec2(x+1,y+1),Vec2(x+1.1,y),Vec2(x+1,y+1)))}
				if(isSolidHLine(grid(x+1,y))&&isSolidVLine(grid(x-1,y+1))){grid.setUsed(x-1,y+1);grid.setUsed(x,y);grid.setUsed(x+1,y);pathSet.insert(new Path(Vec2(x+1,y),Vec2(x-1,y+1),Vec2(x-1.1,y),Vec2(x-1,y+1)))}}
				if(((c===')')||isPoint(c))&&(grid(x-1,y-1)==='.')&&(grid(x-1,y+1)==="\'")){grid.setUsed(x,y);grid.setUsed(x-1,y-1);grid.setUsed(x-1,y+1);pathSet.insert(new Path(Vec2(x-2,y-1),Vec2(x-2,y+1),Vec2(x+0.6,y-1),Vec2(x+0.6,y+1)))}
				if(((c==='(')||isPoint(c))&&(grid(x+1,y-1)==='.')&&(grid(x+1,y+1)==="\'")){grid.setUsed(x,y);grid.setUsed(x+1,y-1);grid.setUsed(x+1,y+1);pathSet.insert(new Path(Vec2(x+2,y-1),Vec2(x+2,y+1),Vec2(x-0.6,y-1),Vec2(x-0.6,y+1)))}
				if(isBottomVertex(c)){if(isSolidHLine(grid(x-1,y))&&isSolidVLine(grid(x+1,y-1))){grid.setUsed(x-1,y);grid.setUsed(x,y);grid.setUsed(x+1,y-1);pathSet.insert(new Path(Vec2(x-1,y),Vec2(x+1,y-1),Vec2(x+1.1,y),Vec2(x+1,y-1)))}
					if(isSolidHLine(grid(x+1,y))&&isSolidVLine(grid(x-1,y-1))){grid.setUsed(x-1,y-1);grid.setUsed(x,y);grid.setUsed(x+1,y);pathSet.insert(new Path(Vec2(x+1,y),Vec2(x-1,y-1),Vec2(x-1.1,y),Vec2(x-1,y-1)))}}}}
			for(var y=0;y<grid.height;++y){for(var x=0;x<grid.width-2;++x){var lt=grid(x-1,y);if((grid(x,y)==='_')&&(grid(x+1,y)==='_')&&(!isASCIILetter(grid(x+2,y))||(lt==='_'))&&(!isASCIILetter(lt)||(grid(x+2,y)==='_'))){var ltlt=grid(x-2,y);var A=Vec2(x-0.5,y+0.5);if((lt==='|')||(grid(x-1,y+1)==='|')||(lt==='.')||(grid(x-1,y+1)==="'")){A.x-=0.5;if((lt==='.')&&((ltlt==='-')||(ltlt==='.'))&&(grid(x-2,y+1)==='(')){A.x-=0.5}}else if(lt==='/'){A.x-=1.0}
				if((lt==='(')&&(ltlt==='(')&&(grid(x,y+1)==="'")&&(grid(x,y-1)==='.')){A.x+=0.5}
				lt=ltlt=undefined;do{grid.setUsed(x,y);++x}while(grid(x,y)==='_');var B=Vec2(x-0.5,y+0.5);var c=grid(x,y);var rt=grid(x+1,y);var dn=grid(x,y+1);if((c==='|')||(dn==='|')||(c==='.')||(dn==="'")){B.x+=0.5;if((c==='.')&&((rt==='-')||(rt==='.'))&&(grid(x+1,y+1)===')')){B.x+=0.5}}else if((c==='\\')){B.x+=1.0}
				if((c===')')&&(rt===')')&&(grid(x-1,y+1)==="'")&&(grid(x-1,y-1)==='.')){B.x+=-0.5}
				pathSet.insert(new Path(A,B))}}}}
		function findDecorations(grid,pathSet,decorationSet){function isEmptyOrVertex(c){return(c===' ')||/[^a-zA-Z0-9]|[ov]/.test(c)}
			function isLetter(c){var x=c.toUpperCase().charCodeAt(0);return(x>64)&&(x<91)}
			function onLine(up,dn,lt,rt){return((isEmptyOrVertex(dn)||isPoint(dn))&&(isEmptyOrVertex(up)||isPoint(up))&&isEmptyOrVertex(rt)&&isEmptyOrVertex(lt))}
			for(var x=0;x<grid.width;++x){for(var j=0;j<grid.height;++j){var c=grid(x,j);var y=j;if(isJump(c)){if(pathSet.downEndsAt(x,y-0.5)&&pathSet.upEndsAt(x,y+0.5)){decorationSet.insert(x,y,c);grid.setUsed(x,y)}}else if(isPoint(c)){var up=grid(x,y-1);var dn=grid(x,y+1);var lt=grid(x-1,y);var rt=grid(x+1,y);var llt=grid(x-2,y);var rrt=grid(x+2,y);if(pathSet.rightEndsAt(x-1,y)||pathSet.leftEndsAt(x+1,y)||pathSet.downEndsAt(x,y-1)||pathSet.upEndsAt(x,y+1)||pathSet.upEndsAt(x,y)||pathSet.downEndsAt(x,y)||onLine(up,dn,lt,rt)){decorationSet.insert(x,y,c);grid.setUsed(x,y)}}else if(isGray(c)){decorationSet.insert(x,y,c);grid.setUsed(x,y)}else if(isTri(c)){decorationSet.insert(x,y,c);grid.setUsed(x,y)}else{var dx=0;if((c==='>')&&(pathSet.rightEndsAt(x,y)||pathSet.horizontalPassesThrough(x,y))){if(isPoint(grid(x+1,y))){dx=-0.5}
				decorationSet.insert(x+dx,y,'>',0);grid.setUsed(x,y)}else if((c==='<')&&(pathSet.leftEndsAt(x,y)||pathSet.horizontalPassesThrough(x,y))){if(isPoint(grid(x-1,y))){dx=0.5}
				decorationSet.insert(x+dx,y,'>',180);grid.setUsed(x,y)}else if(c==='^'){if(pathSet.upEndsAt(x,y-0.5)){decorationSet.insert(x,y-0.5,'>',270);grid.setUsed(x,y)}else if(pathSet.upEndsAt(x,y)){decorationSet.insert(x,y,'>',270);grid.setUsed(x,y)}else if(pathSet.diagonalUpEndsAt(x+0.5,y-0.5)){decorationSet.insert(x+0.5,y-0.5,'>',270+DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.diagonalUpEndsAt(x+0.25,y-0.25)){decorationSet.insert(x+0.25,y-0.25,'>',270+DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.diagonalUpEndsAt(x,y)){decorationSet.insert(x,y,'>',270+DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.backDiagonalUpEndsAt(x,y)){decorationSet.insert(x,y,c,270-DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.backDiagonalUpEndsAt(x-0.5,y-0.5)){decorationSet.insert(x-0.5,y-0.5,c,270-DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.backDiagonalUpEndsAt(x-0.25,y-0.25)){decorationSet.insert(x-0.25,y-0.25,c,270-DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.verticalPassesThrough(x,y)){decorationSet.insert(x,y-0.5,'>',270);grid.setUsed(x,y)}}else if(c==='v'){if(pathSet.downEndsAt(x,y+0.5)){decorationSet.insert(x,y+0.5,'>',90);grid.setUsed(x,y)}else if(pathSet.downEndsAt(x,y)){decorationSet.insert(x,y,'>',90);grid.setUsed(x,y)}else if(pathSet.diagonalDownEndsAt(x,y)){decorationSet.insert(x,y,'>',90+DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.diagonalDownEndsAt(x-0.5,y+0.5)){decorationSet.insert(x-0.5,y+0.5,'>',90+DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.diagonalDownEndsAt(x-0.25,y+0.25)){decorationSet.insert(x-0.25,y+0.25,'>',90+DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.backDiagonalDownEndsAt(x,y)){decorationSet.insert(x,y,'>',90-DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.backDiagonalDownEndsAt(x+0.5,y+0.5)){decorationSet.insert(x+0.5,y+0.5,'>',90-DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.backDiagonalDownEndsAt(x+0.25,y+0.25)){decorationSet.insert(x+0.25,y+0.25,'>',90-DIAGONAL_ANGLE);grid.setUsed(x,y)}else if(pathSet.verticalPassesThrough(x,y)){decorationSet.insert(x,y+0.5,'>',90);grid.setUsed(x,y)}}}}}}
		var grid=makeGrid(diagramString);var pathSet=new PathSet();var decorationSet=new DecorationSet();findPaths(grid,pathSet);findDecorations(grid,pathSet,decorationSet);var svg='<svg class="diagram" xmlns="http://www.w3.org/2000/svg" version="1.1" height="'+((grid.height+1)*SCALE*ASPECT)+'" width="'+((grid.width+1)*SCALE)+'"';if(alignmentHint==='floatleft'){svg+=' style="float:left;margin:15px 30px 15px 0;"'}else if(alignmentHint==='floatright'){svg+=' style="float:right;margin:15px 0 15px 30px;"'}else if(alignmentHint==='center'){svg+=' style="margin:0 auto 0 auto;"'}
		svg+='><g transform="translate('+Vec2(1,1)+')">\n';if(DEBUG_SHOW_GRID){svg+='<g style="opacity:0.1">\n';for(var x=0;x<grid.width;++x){for(var y=0;y<grid.height;++y){svg+='<rect x="'+((x-0.5)*SCALE+1)+'" + y="'+((y-0.5)*SCALE*ASPECT+2)+'" width="'+(SCALE-2)+'" height="'+(SCALE*ASPECT-2)+'" style="fill:';if(grid.isUsed(x,y)){svg+='red;'}else if(grid(x,y)===' '){svg+='gray;opacity:0.05'}else{svg+='blue;'}
			svg+='"/>\n'}}
			svg+='</g>\n'}
		svg+=pathSet.toSVG();svg+=decorationSet.toSVG();if(!DEBUG_HIDE_PASSTHROUGH){svg+='<g transform="translate(0,0)">';for(var y=0;y<grid.height;++y){for(var x=0;x<grid.width;++x){var c=grid(x,y);if(/[\u2B22\u2B21]/.test(c)){svg+='<text text-anchor="middle" x="'+(x*SCALE)+'" y="'+(4+y*SCALE*ASPECT)+'" style="font-size:20.5px">'+escapeHTMLEntities(c)+'</text>'}else if((c!==' ')&&!grid.isUsed(x,y)){svg+='<text text-anchor="middle" x="'+(x*SCALE)+'" y="'+(4+y*SCALE*ASPECT)+'">'+escapeHTMLEntities(c)+'</text>'}}}
			svg+='</g>'}
		if(DEBUG_SHOW_SOURCE){svg+='<g transform="translate(2,2)">\n';for(var x=0;x<grid.width;++x){for(var y=0;y<grid.height;++y){var c=grid(x,y);if(c!==' '){svg+='<text text-anchor="middle" x="'+(x*SCALE)+'" y="'+(4+y*SCALE*ASPECT)+'" style="fill:#F00;font-family:Menlo,monospace;font-size:12px;text-align:center">'+escapeHTMLEntities(c)+'</text>'}}}
			svg+='</g>'}
		svg+='</g></svg>';svg=svg.rp(new RegExp(HIDE_O,'g'),'o');return svg}
	var HIGHLIGHT_STYLESHEET="<style>.hljs{display:block;overflow-x:auto;padding:0.5em;background:#fff;color:#000;-webkit-text-size-adjust:none}"+".hljs-comment{color:#006a00}"+".hljs-keyword{color:#02E}"+".hljs-literal,.nginx .hljs-title{color:#aa0d91}"+".method,.hljs-list .hljs-title,.hljs-tag .hljs-title,.setting .hljs-value,.hljs-winutils,.tex .hljs-command,.http .hljs-title,.hljs-request,.hljs-status,.hljs-name{color:#008}"+".hljs-envvar,.tex .hljs-special{color:#660}"+".hljs-string{color:#c41a16}"+".hljs-tag .hljs-value,.hljs-cdata,.hljs-filter .hljs-argument,.hljs-attr_selector,.apache .hljs-cbracket,.hljs-date,.hljs-regexp{color:#080}"+".hljs-sub .hljs-identifier,.hljs-pi,.hljs-tag,.hljs-tag .hljs-keyword,.hljs-decorator,.ini .hljs-title,.hljs-shebang,.hljs-prompt,.hljs-hexcolor,.hljs-rule .hljs-value,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-number,.css .hljs-function,.hljs-function .hljs-title,.coffeescript .hljs-attribute{color:#A0C}"+".hljs-function .hljs-title{font-weight:bold;color:#000}"+".hljs-class .hljs-title,.smalltalk .hljs-class,.hljs-type,.hljs-typename,.hljs-tag .hljs-attribute,.hljs-doctype,.hljs-class .hljs-id,.hljs-built_in,.setting,.hljs-params,.clojure .hljs-attribute{color:#5c2699}"+".hljs-variable{color:#3f6e74}"+".css .hljs-tag,.hljs-rule .hljs-property,.hljs-pseudo,.hljs-subst{color:#000}"+".css .hljs-class,.css .hljs-id{color:#9b703f}"+".hljs-value .hljs-important{color:#ff7700;font-weight:bold}"+".hljs-rule .hljs-keyword{color:#c5af75}"+".hljs-annotation,.apache .hljs-sqbracket,.nginx .hljs-built_in{color:#9b859d}"+".hljs-preprocessor,.hljs-preprocessor *,.hljs-pragma{color:#643820}"+".tex .hljs-formula{background-color:#eee;font-style:italic}"+".diff .hljs-header,.hljs-chunk{color:#808080;font-weight:bold}"+".diff .hljs-change{background-color:#bccff9}"+".hljs-addition{background-color:#baeeba}"+".hljs-deletion{background-color:#ffc8bd}"+".hljs-comment .hljs-doctag{font-weight:bold}"+".method .hljs-id{color:#000}</style>";function isMarkdeepScriptName(str){return str.search(/markdeep\S*?\.js$/i)!==-1}
	function toArray(list){return Array.prototype.slice.call(list)}
	if(!window.alreadyProcessedMarkdeep){window.alreadyProcessedMarkdeep=!0;var noformat=(window.location.href.search(/\?.*noformat.*/i)!==-1);window.markdeep=Object.freeze({format:markdeepToHTML,formatDiagram:diagramToSVG,stylesheet:function(){return STYLESHEET+sectionNumberingStylesheet()+HIGHLIGHT_STYLESHEET}});var MATHJAX_CONFIG='<script type="text/x-mathjax-config">MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });</script>'+'<span style="display:none">'+'$$NC{\\n}{\\hat{n}}NC{\\w}{\\hat{\\omega}}NC{\\wi}{\\w_\\mathrm{i}}NC{\\wo}{\\w_\\mathrm{o}}NC{\\wh}{\\w_\\mathrm{h}}NC{\\Li}{L_\\mathrm{i}}NC{\\Lo}{L_\\mathrm{o}}NC{\\Le}{L_\\mathrm{e}}NC{\\Lr}{L_\\mathrm{r}}NC{\\Lt}{L_\\mathrm{t}}NC{\\O}{\\mathrm{O}}NC{\\degrees}{{^{\\large\\circ}}}NC{\\T}{\\mathsf{T}}NC{\\mathset}[1]{\\mathbb{#1}}NC{\\Real}{\\mathset{R}}NC{\\Integer}{\\mathset{Z}}NC{\\Boolean}{\\mathset{B}}NC{\\Complex}{\\mathset{C}}NC{\\un}[1]{\\,\\mathrm{#1}}$$\n'.rp(/NC/g,'\\newcommand')+'</span>\n'
		var MATHJAX_URL='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'
		function loadMathJax(){var script=document.createElement("script");script.type="text/javascript";script.src=MATHJAX_URL;document.getElementsByTagName("head")[0].appendChild(script)}
		function needsMathJax(html){return option('detectMath')&&((html.search(/(?:\$\$[\s\S]+\$\$)|(?:\\begin{)/m)!==-1)||(html.search(/\\\(.*\\\)/)!==-1))}
		var mode=option('mode');switch(mode){case 'script':return;case 'html':case 'doxygen':toArray(document.getElementsByClassName('diagram')).concat(toArray(document.getElementsByTagName('diagram'))).forEach(function(element){var src=unescapeHTMLEntities(element.innerHTML);src=src.rp(/(:?^[ \t]*\n)|(:?\n[ \t]*)$/g,'');if(mode==='doxygen'){src=src.rp(new RegExp('\u2013','g'),'--');src=src.rp(new RegExp('\u2014','g'),'---');src=src.rp(/<a class="el" .*>(.*)<\/a>/g,'$1')}
			element.outerHTML='<center class="md">'+diagramToSVG(removeLeadingSpace(src),'')+'</center>'});var anyNeedsMathJax=!1;toArray(document.getElementsByClassName('markdeep')).concat(toArray(document.getElementsByTagName('markdeep'))).forEach(function(src){var dst=document.createElement('div');var html=markdeepToHTML(removeLeadingSpace(unescapeHTMLEntities(src.innerHTML)),!0);anyNeedsMathJax=anyNeedsMathJax||needsMathJax(html);dst.innerHTML=html;src.parentNode.replaceChild(dst,src)});document.head.innerHTML=window.markdeep.stylesheet()+document.head.innerHTML+(anyNeedsMathJax?MATHJAX_CONFIG:'');loadMathJax();return}
		if(!noformat){toArray(document.getElementsByTagName('script')).forEach(function(node){if(isMarkdeepScriptName(node.src)){node.parentNode.removeChild(node)}});document.body.style.visibility='hidden'}
		var source=nodeToMarkdeepSource(document.body);if(noformat){source=source.rp(/<!-- Markdeep:.+$/gm,'')+MARKDEEP_LINE;source=source.rp(/</g,'&lt;').rp(/>/g,'&gt;');document.body.innerHTML=entag('pre',source);var fallbackNodes=document.getElementsByClassName('fallback');for(var i=0;i<fallbackNodes.length;++i){fallbackNodes[i].remove()}
			return}
		var markdeepProcessor=function(){var source=nodeToMarkdeepSource(document.body);var markdeepHTML=markdeepToHTML(source,!1);var needMathJax=needsMathJax(markdeepHTML);if(needMathJax){markdeepHTML=MATHJAX_CONFIG+markdeepHTML}
			markdeepHTML+=MARKDEEP_FOOTER;var longDocument=source.length>1000;var head=BODY_STYLESHEET+STYLESHEET+sectionNumberingStylesheet()+HIGHLIGHT_STYLESHEET;if(longDocument){head+=entag('style','div.title { padding-top: 40px; } div.afterTitles { height: 15px; }')}
			if(window.location.href.search(/\?.*export.*/i)!==-1){var text='<meta charset="UTF-8"><meta http-equiv="content-type" content="text/html;charset=UTF-8">'+head+document.head.innerHTML+markdeepHTML;if(needMathJax){text+='<script src="'+MATHJAX_URL+'"></script>'}
				document.body.innerHTML=entag('code',escapeHTMLEntities(text))}else{document.head.innerHTML='<meta charset="UTF-8"><meta http-equiv="content-type" content="text/html;charset=UTF-8">'+head+document.head.innerHTML;document.body.innerHTML=markdeepHTML;if(needMathJax){loadMathJax()}}
			document.body.style.visibility='visible'};function sendContentsToMyParent(){parent.postMessage(myID+'='+document.body.innerHTML,'*')}
		function removeFilename(url){return url&&url.ss(0,url.lastIndexOf('/')+1)}
		var myURLParse=/([^?]+)(?:\?id=(inc\d+)&p=([^&]+))?/.exec(location.href);var myBase=removeFilename(myURLParse[1]);var myID=myURLParse[2];var parentBase=removeFilename(myURLParse[3]&&decodeURIComponent(myURLParse[3]));var childFrameStyle='display:none';var includeCounter=0;var IAmAChild=myID;var IAmAParent=!1;var numIncludeChildrenLeft=0;var messageCallback=function(event){var childID=!1;var childBody=event.data.substring&&event.data.replace(/^(inc\d+)=/,function(match,a){childID=a;return''});if(childID){var childFrame=document.getElementById(childID);childFrame.outerHTML='\n'+childBody+'\n';--numIncludeChildrenLeft;if(numIncludeChildrenLeft<=0){if(IAmAChild){sendContentsToMyParent()}else{setTimeout(markdeepProcessor,1)}}}};source=source.rp(/(?:^|\s)\(insert[ \t]+(\S+\.\S*)[ \t]+here\)\s/g,function(match,src){if(numIncludeChildrenLeft===0){IAmAParent=!0;addEventListener("message",messageCallback)}
			++numIncludeChildrenLeft;var childID='inc'+(++includeCounter);return'<iframe src="'+src+'?id='+childID+'&p='+encodeURIComponent(myBase)+'" id="'+childID+'" style="'+childFrameStyle+'" content="text/html;charset=UTF-8"></iframe>'});if(IAmAParent){document.body.innerHTML=source}else if(IAmAChild){sendContentsToMyParent()}else{setTimeout(markdeepProcessor,1)}}})()